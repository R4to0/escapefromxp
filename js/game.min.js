/*! Built with IMPACT - impactjs.com */

(function(window){"use strict";Number.prototype.map=function(istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((this-istart)/(istop-istart));};Number.prototype.limit=function(min,max){return Math.min(max,Math.max(min,this));};Number.prototype.round=function(precision){precision=Math.pow(10,precision||0);return Math.round(this*precision)/precision;};Number.prototype.floor=function(){return Math.floor(this);};Number.prototype.ceil=function(){return Math.ceil(this);};Number.prototype.toInt=function(){return(this|0);};Number.prototype.toRad=function(){return(this/180)*Math.PI;};Number.prototype.toDeg=function(){return(this*180)/Math.PI;};Array.prototype.erase=function(item){for(var i=this.length;i--;){if(this[i]===item){this.splice(i,1);}}
return this;};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)];};Function.prototype.bind=Function.prototype.bind||function(oThis){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}
var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply((this instanceof fNOP&&oThis?this:oThis),aArgs.concat(Array.prototype.slice.call(arguments)));};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound;};window.ig={game:null,debug:null,version:'1.23',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector.charAt(0)=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:function(name){return document.createElement(name);},copy:function(object){if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(object instanceof Array){var c=[];for(var i=0,l=object.length;i<l;i++){c[i]=ig.copy(object[i]);}
return c;}
else{var c={};for(var i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class||ext===null){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var i in obj){keys.push(i);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);el[attr]=el['ms'+uc]=el['moz'+uc]=el['webkit'+uc]=el['o'+uc]=val;},getVendorAttribute:function(el,attr){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},getImagePixels:function(image,x,y,width,height){var canvas=ig.$new('canvas');canvas.width=image.width;canvas.height=image.height;var ctx=canvas.getContext('2d');ig.System.SCALE.CRISP(canvas,ctx);var ratio=ig.getVendorAttribute(ctx,'backingStorePixelRatio')||1;ig.normalizeVendorAttribute(ctx,'getImageDataHD');var realWidth=image.width/ratio,realHeight=image.height/ratio;canvas.width=Math.ceil(realWidth);canvas.height=Math.ceil(realHeight);ctx.drawImage(image,0,0,realWidth,realHeight);return(ratio===1)?ctx.getImageData(x,y,width,height):ctx.getImageDataHD(x,y,width,height);},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache=set?'?'+Date.now():'';},log:function(){},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.src=path;script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};ig.$('head')[0].appendChild(script);},_execModules:function(){var modulesLoaded=false;for(var i=0;i<ig._loadQueue.length;i++){var m=ig._loadQueue[i];var dependenciesLoaded=true;for(var j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload==0&&ig._loadQueue.length!=0){var unresolved=[];for(var i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(var j=0;j<requires.length;j++){var m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw("Unresolved (or circular?) dependencies. "+"Most likely there's a name/path mismatch for one of the listed modules "+"or a previous syntax error prevents a module from loading:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){if(document.location.href.match(/\?nocache/)){ig.setNocache(true);}
ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=(ig.ua.iPhone&&ig.ua.pixelRatio==2);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;if(document.readyState==='complete'){ig._DOMReady();}
else{document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}}};ig.normalizeVendorAttribute(window,'requestAnimationFrame');if(window.requestAnimationFrame){var next=1,anims={};window.ig.setAnimation=function(callback,element){var current=next++;anims[current]=true;var animate=function(){if(!anims[current]){return;}
window.requestAnimationFrame(animate,element);callback();};window.requestAnimationFrame(animate,element);return current;};window.ig.clearAnimation=function(id){delete anims[id];};}
else{window.ig.setAnimation=function(callback,element){return window.setInterval(callback,1000/60);};window.ig.clearAnimation=function(id){window.clearInterval(id);};}
var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;var lastClassId=0;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;Class.classId=prototype.classId=++lastClassId;return Class;};if(window.ImpactMixin){ig.merge(ig,window.ImpactMixin);}})(window);

// lib/impact/image.js
ig.baked=true;ig.module('impact.image').defines(function(){"use strict";ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:false,failed:false,loadCallback:null,path:'',staticInstantiate:function(path){return ig.Image.cache[path]||null;},init:function(path){this.path=path;this.load();},load:function(loadCallback){if(this.loaded){if(loadCallback){loadCallback(this.path,true);}
return;}
else if(!this.loaded&&ig.ready){this.loadCallback=loadCallback||null;this.data=new Image();this.data.onload=this.onload.bind(this);this.data.onerror=this.onerror.bind(this);this.data.src=ig.prefix+this.path+ig.nocache;}
else{ig.addResource(this);}
ig.Image.cache[this.path]=this;},reload:function(){this.loaded=false;this.data=new Image();this.data.onload=this.onload.bind(this);this.data.src=this.path+'?'+Date.now();},onload:function(event){this.width=this.data.width;this.height=this.data.height;this.loaded=true;if(ig.system.scale!=1){this.resize(ig.system.scale);}
if(this.loadCallback){this.loadCallback(this.path,true);}},onerror:function(event){this.failed=true;if(this.loadCallback){this.loadCallback(this.path,false);}},resize:function(scale){var origPixels=ig.getImagePixels(this.data,0,0,this.width,this.height);var widthScaled=this.width*scale;var heightScaled=this.height*scale;var scaled=ig.$new('canvas');scaled.width=widthScaled;scaled.height=heightScaled;var scaledCtx=scaled.getContext('2d');var scaledPixels=scaledCtx.getImageData(0,0,widthScaled,heightScaled);for(var y=0;y<heightScaled;y++){for(var x=0;x<widthScaled;x++){var index=(Math.floor(y/scale)*this.width+Math.floor(x/scale))*4;var indexScaled=(y*widthScaled+x)*4;scaledPixels.data[indexScaled]=origPixels.data[index];scaledPixels.data[indexScaled+1]=origPixels.data[index+1];scaledPixels.data[indexScaled+2]=origPixels.data[index+2];scaledPixels.data[indexScaled+3]=origPixels.data[index+3];}}
scaledCtx.putImageData(scaledPixels,0,0);this.data=scaled;},draw:function(targetX,targetY,sourceX,sourceY,width,height){if(!this.loaded){return;}
var scale=ig.system.scale;sourceX=sourceX?sourceX*scale:0;sourceY=sourceY?sourceY*scale:0;width=(width?width:this.width)*scale;height=(height?height:this.height)*scale;ig.system.context.drawImage(this.data,sourceX,sourceY,width,height,ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY),width,height);ig.Image.drawCount++;},drawTile:function(targetX,targetY,tile,tileWidth,tileHeight,flipX,flipY){tileHeight=tileHeight?tileHeight:tileWidth;if(!this.loaded||tileWidth>this.width||tileHeight>this.height){return;}
var scale=ig.system.scale;var tileWidthScaled=Math.floor(tileWidth*scale);var tileHeightScaled=Math.floor(tileHeight*scale);var scaleX=flipX?-1:1;var scaleY=flipY?-1:1;if(flipX||flipY){ig.system.context.save();ig.system.context.scale(scaleX,scaleY);}
ig.system.context.drawImage(this.data,(Math.floor(tile*tileWidth)%this.width)*scale,(Math.floor(tile*tileWidth/this.width)*tileHeight)*scale,tileWidthScaled,tileHeightScaled,ig.system.getDrawPos(targetX)*scaleX-(flipX?tileWidthScaled:0),ig.system.getDrawPos(targetY)*scaleY-(flipY?tileHeightScaled:0),tileWidthScaled,tileHeightScaled);if(flipX||flipY){ig.system.context.restore();}
ig.Image.drawCount++;}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var path in ig.Image.cache){ig.Image.cache[path].reload();}};});

// lib/impact/font.js
ig.baked=true;ig.module('impact.font').requires('impact.image').defines(function(){"use strict";ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(ev){this._loadMetrics(this.data);this.parent(ev);},widthForString:function(text){if(text.indexOf('\n')!==-1){var lines=text.split('\n');var width=0;for(var i=0;i<lines.length;i++){width=Math.max(width,this._widthForLine(lines[i]));}
return width;}
else{return this._widthForLine(text);}},_widthForLine:function(text){var width=0;for(var i=0;i<text.length;i++){width+=this.widthMap[text.charCodeAt(i)-this.firstChar]+this.letterSpacing;}
return width;},heightForString:function(text){return text.split('\n').length*(this.height+this.lineSpacing);},draw:function(text,x,y,align){if(typeof(text)!='string'){text=text.toString();}
if(text.indexOf('\n')!==-1){var lines=text.split('\n');var lineHeight=this.height+this.lineSpacing;for(var i=0;i<lines.length;i++){this.draw(lines[i],x,y+i*lineHeight,align);}
return;}
if(align==ig.Font.ALIGN.RIGHT||align==ig.Font.ALIGN.CENTER){var width=this._widthForLine(text);x-=align==ig.Font.ALIGN.CENTER?width/2:width;}
if(this.alpha!==1){ig.system.context.globalAlpha=this.alpha;}
for(var i=0;i<text.length;i++){var c=text.charCodeAt(i);x+=this._drawChar(c-this.firstChar,x,y);}
if(this.alpha!==1){ig.system.context.globalAlpha=1;}
ig.Image.drawCount+=text.length;},_drawChar:function(c,targetX,targetY){if(!this.loaded||c<0||c>=this.indices.length){return 0;}
var scale=ig.system.scale;var charX=this.indices[c]*scale;var charY=0;var charWidth=this.widthMap[c]*scale;var charHeight=(this.height-2)*scale;ig.system.context.drawImage(this.data,charX,charY,charWidth,charHeight,ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY),charWidth,charHeight);return this.widthMap[c]+this.letterSpacing;},_loadMetrics:function(image){this.height=image.height-1;this.widthMap=[];this.indices=[];var px=ig.getImagePixels(image,0,image.height-1,image.width,1);var currentChar=0;var currentWidth=0;for(var x=0;x<image.width;x++){var index=x*4+3;if(px.data[index]>127){currentWidth++;}
else if(px.data[index]<128&&currentWidth){this.widthMap.push(currentWidth);this.indices.push(x-currentWidth);currentChar++;currentWidth=0;}}
this.widthMap.push(currentWidth);this.indices.push(x-currentWidth);}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2};});

// lib/impact/sound.js
ig.baked=true;ig.module('impact.sound').defines(function(){"use strict";ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio){ig.Sound.enabled=false;return;}
var probe=new Audio();for(var i=0;i<ig.Sound.use.length;i++){var format=ig.Sound.use[i];if(probe.canPlayType(format.mime)){this.format=format;break;}}
if(!this.format){ig.Sound.enabled=false;}},load:function(path,multiChannel,loadCallback){var realPath=ig.prefix+path.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[path]){if(multiChannel&&this.clips[path].length<ig.Sound.channels){for(var i=this.clips[path].length;i<ig.Sound.channels;i++){var a=new Audio(realPath);a.load();this.clips[path].push(a);}}
return this.clips[path][0];}
var clip=new Audio(realPath);if(loadCallback){clip.addEventListener('canplaythrough',function cb(ev){clip.removeEventListener('canplaythrough',cb,false);loadCallback(path,true,ev);},false);clip.addEventListener('error',function(ev){loadCallback(path,false,ev);},false);}
clip.preload='auto';clip.load();this.clips[path]=[clip];if(multiChannel){for(var i=1;i<ig.Sound.channels;i++){var a=new Audio(realPath);a.load();this.clips[path].push(a);}}
return clip;},get:function(path){var channels=this.clips[path];for(var i=0,clip;clip=channels[i++];){if(clip.paused||clip.ended){if(clip.ended){clip.currentTime=0;}
return clip;}}
channels[0].pause();channels[0].currentTime=0;return channels[0];}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:false,_volume:1,_loop:false,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);if(Object.defineProperty){Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)});Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});}
else if(this.__defineGetter__){this.__defineGetter__('volume',this.getVolume.bind(this));this.__defineSetter__('volume',this.setVolume.bind(this));this.__defineGetter__('loop',this.getLooping.bind(this));this.__defineSetter__('loop',this.setLooping.bind(this));}},add:function(music,name){if(!ig.Sound.enabled){return;}
var path=music instanceof ig.Sound?music.path:music;var track=ig.soundManager.load(path,false);track.loop=this._loop;track.volume=this._volume;track.addEventListener('ended',this._endedCallbackBound,false);this.tracks.push(track);if(name){this.namedTracks[name]=track;}
if(!this.currentTrack){this.currentTrack=track;}},next:function(){if(!this.tracks.length){return;}
this.stop();this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length;this.currentTrack=this.tracks[this.currentIndex];this.play();},pause:function(){if(!this.currentTrack){return;}
this.currentTrack.pause();},stop:function(){if(!this.currentTrack){return;}
this.currentTrack.pause();this.currentTrack.currentTime=0;},play:function(name){if(name&&this.namedTracks[name]){var newTrack=this.namedTracks[name];if(newTrack!=this.currentTrack){this.stop();this.currentTrack=newTrack;}}
else if(!this.currentTrack){return;}
this.currentTrack.play();},getLooping:function(){return this._loop;},setLooping:function(l){this._loop=l;for(var i in this.tracks){this.tracks[i].loop=l;}},getVolume:function(){return this._volume;},setVolume:function(v){this._volume=v.limit(0,1);for(var i in this.tracks){this.tracks[i].volume=this._volume;}},fadeOut:function(time){if(!this.currentTrack){return;}
clearInterval(this._fadeInterval);this.fadeTimer=new ig.Timer(time);this._fadeInterval=setInterval(this._fadeStep.bind(this),50);},_fadeStep:function(){var v=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;if(v<=0.01){this.stop();this.currentTrack.volume=this._volume;clearInterval(this._fadeInterval);}
else{this.currentTrack.volume=v;}},_endedCallback:function(){if(this._loop){this.play();}
else{this.next();}}});ig.Sound=ig.Class.extend({path:'',volume:1,currentClip:null,multiChannel:true,init:function(path,multiChannel){this.path=path;this.multiChannel=(multiChannel!==false);this.load();},load:function(loadCallback){if(!ig.Sound.enabled){if(loadCallback){loadCallback(this.path,true);}
return;}
if(ig.ready){ig.soundManager.load(this.path,this.multiChannel,loadCallback);}
else{ig.addResource(this);}},play:function(){if(!ig.Sound.enabled){return;}
this.currentClip=ig.soundManager.get(this.path);this.currentClip.volume=ig.soundManager.volume*this.volume;this.currentClip.play();},stop:function(){if(this.currentClip){this.currentClip.pause();this.currentClip.currentTime=0;}}});ig.Sound.FORMAT={MP3:{ext:'mp3',mime:'audio/mpeg'},M4A:{ext:'m4a',mime:'audio/mp4; codecs=mp4a'},OGG:{ext:'ogg',mime:'audio/ogg; codecs=vorbis'},WEBM:{ext:'webm',mime:'audio/webm; codecs=vorbis'},CAF:{ext:'caf',mime:'audio/x-caf'}};ig.Sound.use=[ig.Sound.FORMAT.MP3,ig.Sound.FORMAT.OGG];ig.Sound.channels=2;ig.Sound.enabled=true;});

// lib/impact/loader.js
ig.baked=true;ig.module('impact.loader').requires('impact.image','impact.font','impact.sound').defines(function(){"use strict";ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:false,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(gameClass,resources){this.gameClass=gameClass;this.resources=resources;this._loadCallbackBound=this._loadCallback.bind(this);for(var i=0;i<this.resources.length;i++){this._unloaded.push(this.resources[i].path);}},load:function(){ig.system.clear('#000');if(!this.resources.length){this.end();return;}
for(var i=0;i<this.resources.length;i++){this.loadResource(this.resources[i]);}
this._intervalId=setInterval(this.draw.bind(this),16);},loadResource:function(res){res.load(this._loadCallbackBound);},end:function(){if(this.done){return;}
this.done=true;clearInterval(this._intervalId);ig.system.setGame(this.gameClass);},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var s=ig.system.scale;var w=ig.system.width*0.6;var h=ig.system.height*0.1;var x=ig.system.width*0.5-w/2;var y=ig.system.height*0.5-h/2;ig.system.context.fillStyle='#000';ig.system.context.fillRect(0,0,480,320);ig.system.context.fillStyle='#fff';ig.system.context.fillRect(x*s,y*s,w*s,h*s);ig.system.context.fillStyle='#000';ig.system.context.fillRect(x*s+s,y*s+s,w*s-s-s,h*s-s-s);ig.system.context.fillStyle='#fff';ig.system.context.fillRect(x*s,y*s,w*s*this._drawStatus,h*s);},_loadCallback:function(path,status){if(status){this._unloaded.erase(path);}
else{throw('Failed to load resource: '+path);}
this.status=1-(this._unloaded.length/this.resources.length);if(this._unloaded.length==0){setTimeout(this.end.bind(this),250);}}});});

// lib/impact/timer.js
ig.baked=true;ig.module('impact.timer').defines(function(){"use strict";ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(seconds){this.base=ig.Timer.time;this.last=ig.Timer.time;this.target=seconds||0;},set:function(seconds){this.target=seconds||0;this.base=ig.Timer.time;this.pausedAt=0;},reset:function(){this.base=ig.Timer.time;this.pausedAt=0;},tick:function(){var delta=ig.Timer.time-this.last;this.last=ig.Timer.time;return(this.pausedAt?0:delta);},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target;},pause:function(){if(!this.pausedAt){this.pausedAt=ig.Timer.time;}},unpause:function(){if(this.pausedAt){this.base+=ig.Timer.time-this.pausedAt;this.pausedAt=0;}}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var current=Date.now();var delta=(current-ig.Timer._last)/1000;ig.Timer.time+=Math.min(delta,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=current;};});

// lib/impact/system.js
ig.baked=true;ig.module('impact.system').requires('impact.timer','impact.image').defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:false,delegate:null,clock:null,canvas:null,context:null,init:function(canvasId,fps,width,height,scale){this.fps=fps;this.clock=new ig.Timer();this.canvas=ig.$(canvasId);this.resize(width,height,scale);this.context=this.canvas.getContext('2d');this.getDrawPos=ig.System.drawMode;if(this.scale!=1){ig.System.scaleMode=ig.System.SCALE.CRISP;}
ig.System.scaleMode(this.canvas,this.context);},resize:function(width,height,scale){this.width=width;this.height=height;this.scale=scale||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight;},setGame:function(gameClass){if(this.running){this.newGameClass=gameClass;}
else{this.setGameNow(gameClass);}},setGameNow:function(gameClass){ig.game=new(gameClass)();ig.system.setDelegate(ig.game);},setDelegate:function(object){if(typeof(object.run)=='function'){this.delegate=object;this.startRunLoop();}else{throw('System.setDelegate: No run() function in object');}},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=false;},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this),this.canvas);this.running=true;},clear:function(color){this.context.fillStyle=color;this.context.fillRect(0,0,this.realWidth,this.realHeight);},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();if(this.newGameClass){this.setGameNow(this.newGameClass);this.newGameClass=null;}},getDrawPos:null});ig.System.DRAW={AUTHENTIC:function(p){return Math.round(p)*this.scale;},SMOOTH:function(p){return Math.round(p*this.scale);},SUBPIXEL:function(p){return p*this.scale;}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(canvas,context){ig.setVendorAttribute(context,'imageSmoothingEnabled',false);canvas.style.imageRendering='-moz-crisp-edges';canvas.style.imageRendering='-o-crisp-edges';canvas.style.imageRendering='-webkit-optimize-contrast';canvas.style.imageRendering='crisp-edges';canvas.style.msInterpolationMode='nearest-neighbor';},SMOOTH:function(canvas,context){ig.setVendorAttribute(context,'imageSmoothingEnabled',true);canvas.style.imageRendering='';canvas.style.msInterpolationMode='';}};ig.System.scaleMode=ig.System.SCALE.SMOOTH;});

// lib/impact/input.js
ig.baked=true;ig.module('impact.input').defines(function(){"use strict";ig.KEY={'MOUSE1':-1,'MOUSE2':-3,'MWHEEL_UP':-4,'MWHEEL_DOWN':-5,'BACKSPACE':8,'TAB':9,'ENTER':13,'PAUSE':19,'CAPS':20,'ESC':27,'SPACE':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'UP_ARROW':38,'RIGHT_ARROW':39,'DOWN_ARROW':40,'INSERT':45,'DELETE':46,'_0':48,'_1':49,'_2':50,'_3':51,'_4':52,'_5':53,'_6':54,'_7':55,'_8':56,'_9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'NUMPAD_0':96,'NUMPAD_1':97,'NUMPAD_2':98,'NUMPAD_3':99,'NUMPAD_4':100,'NUMPAD_5':101,'NUMPAD_6':102,'NUMPAD_7':103,'NUMPAD_8':104,'NUMPAD_9':105,'MULTIPLY':106,'ADD':107,'SUBSTRACT':109,'DECIMAL':110,'DIVIDE':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'SHIFT':16,'CTRL':17,'ALT':18,'PLUS':187,'COMMA':188,'MINUS':189,'PERIOD':190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:false,isUsingKeyboard:false,isUsingAccelerometer:false,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(this.isUsingMouse){return;}
this.isUsingMouse=true;var mouseWheelBound=this.mousewheel.bind(this);ig.system.canvas.addEventListener('mousewheel',mouseWheelBound,false);ig.system.canvas.addEventListener('DOMMouseScroll',mouseWheelBound,false);ig.system.canvas.addEventListener('contextmenu',this.contextmenu.bind(this),false);ig.system.canvas.addEventListener('mousedown',this.keydown.bind(this),false);ig.system.canvas.addEventListener('mouseup',this.keyup.bind(this),false);ig.system.canvas.addEventListener('mousemove',this.mousemove.bind(this),false);if(ig.ua.touchDevice){ig.system.canvas.addEventListener('touchstart',this.keydown.bind(this),false);ig.system.canvas.addEventListener('touchend',this.keyup.bind(this),false);ig.system.canvas.addEventListener('touchmove',this.mousemove.bind(this),false);ig.system.canvas.addEventListener('MSPointerDown',this.keydown.bind(this),false);ig.system.canvas.addEventListener('MSPointerUp',this.keyup.bind(this),false);ig.system.canvas.addEventListener('MSPointerMove',this.mousemove.bind(this),false);ig.system.canvas.style.msTouchAction='none';}},initKeyboard:function(){if(this.isUsingKeyboard){return;}
this.isUsingKeyboard=true;window.addEventListener('keydown',this.keydown.bind(this),false);window.addEventListener('keyup',this.keyup.bind(this),false);},initAccelerometer:function(){if(this.isUsingAccelerometer){return;}
window.addEventListener('devicemotion',this.devicemotion.bind(this),false);},mousewheel:function(event){var delta=event.wheelDelta?event.wheelDelta:(event.detail*-1);var code=delta>0?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN;var action=this.bindings[code];if(action){this.actions[action]=true;this.presses[action]=true;this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();}},mousemove:function(event){var internalWidth=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;var scale=ig.system.scale*(internalWidth/ig.system.realWidth);var pos={left:0,top:0};if(ig.system.canvas.getBoundingClientRect){pos=ig.system.canvas.getBoundingClientRect();}
var ev=event.touches?event.touches[0]:event;this.mouse.x=(ev.clientX-pos.left)/scale;this.mouse.y=(ev.clientY-pos.top)/scale;},contextmenu:function(event){if(this.bindings[ig.KEY.MOUSE2]){event.stopPropagation();event.preventDefault();}},keydown:function(event){var tag=event.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=event.type=='keydown'?event.keyCode:(event.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(event.type=='touchstart'||event.type=='mousedown'){this.mousemove(event);}
var action=this.bindings[code];if(action){this.actions[action]=true;if(!this.locks[action]){this.presses[action]=true;this.locks[action]=true;}
event.stopPropagation();event.preventDefault();}},keyup:function(event){var tag=event.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=event.type=='keyup'?event.keyCode:(event.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);var action=this.bindings[code];if(action){this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();}},devicemotion:function(event){this.accel=event.accelerationIncludingGravity;},bind:function(key,action){if(key<0){this.initMouse();}
else if(key>0){this.initKeyboard();}
this.bindings[key]=action;},bindTouch:function(selector,action){var element=ig.$(selector);var that=this;element.addEventListener('touchstart',function(ev){that.touchStart(ev,action);},false);element.addEventListener('touchend',function(ev){that.touchEnd(ev,action);},false);element.addEventListener('MSPointerDown',function(ev){that.touchStart(ev,action);},false);element.addEventListener('MSPointerUp',function(ev){that.touchEnd(ev,action);},false);},unbind:function(key){var action=this.bindings[key];this.delayedKeyup[action]=true;this.bindings[key]=null;},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={};},state:function(action){return this.actions[action];},pressed:function(action){return this.presses[action];},released:function(action){return!!this.delayedKeyup[action];},clearPressed:function(){for(var action in this.delayedKeyup){this.actions[action]=false;this.locks[action]=false;}
this.delayedKeyup={};this.presses={};},touchStart:function(event,action){this.actions[action]=true;this.presses[action]=true;event.stopPropagation();event.preventDefault();return false;},touchEnd:function(event,action){this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();return false;}});});

// lib/impact/impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.loader','impact.system','impact.input','impact.sound').defines(function(){"use strict";ig.main=function(canvasId,gameClass,fps,width,height,scale,loaderClass){ig.system=new ig.System(canvasId,fps,width,height,scale||1);ig.input=new ig.Input();ig.soundManager=new ig.SoundManager();ig.music=new ig.Music();ig.ready=true;var loader=new(loaderClass||ig.Loader)(gameClass,ig.resources);loader.load();};});

// lib/impact/animation.js
ig.baked=true;ig.module('impact.animation').requires('impact.timer','impact.image').defines(function(){"use strict";ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(path,width,height){this.width=width;this.height=height;this.image=new ig.Image(path);}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:false,y:false},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(sheet,frameTime,sequence,stop){this.sheet=sheet;this.pivot={x:sheet.width/2,y:sheet.height/2};this.timer=new ig.Timer();this.frameTime=frameTime;this.sequence=sequence;this.stop=!!stop;this.tile=this.sequence[0];},rewind:function(){this.timer.set();this.loopCount=0;this.frame=0;this.tile=this.sequence[0];return this;},gotoFrame:function(f){this.timer.set(this.frameTime*-f-0.0001);this.update();},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var frameTotal=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(frameTotal/this.sequence.length);if(this.stop&&this.loopCount>0){this.frame=this.sequence.length-1;}
else{this.frame=frameTotal%this.sequence.length;}
this.tile=this.sequence[this.frame];},draw:function(targetX,targetY){var bbsize=Math.max(this.sheet.width,this.sheet.height);if(targetX>ig.system.width||targetY>ig.system.height||targetX+bbsize<0||targetY+bbsize<0){return;}
if(this.alpha!=1){ig.system.context.globalAlpha=this.alpha;}
if(this.angle==0){this.sheet.image.drawTile(targetX,targetY,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);}
else{ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(targetX+this.pivot.x),ig.system.getDrawPos(targetY+this.pivot.y));ig.system.context.rotate(this.angle);this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);ig.system.context.restore();}
if(this.alpha!=1){ig.system.context.globalAlpha=1;}}});});

// lib/impact/entity.js
ig.baked=true;ig.module('impact.entity').requires('impact.animation','impact.impact').defines(function(){"use strict";ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:false,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:false,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(x,y,settings){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=x;this.pos.y=this.last.y=y;ig.merge(this,settings);},reset:function(x,y,settings){var proto=this.constructor.prototype;this.pos.x=x;this.pos.y=y;this.last.x=x;this.last.y=y;this.vel.x=proto.vel.x;this.vel.y=proto.vel.y;this.accel.x=proto.accel.x;this.accel.y=proto.accel.y;this.health=proto.health;this._killed=proto._killed;this.standing=proto.standing;this.type=proto.type;this.checkAgainst=proto.checkAgainst;this.collides=proto.collides;ig.merge(this,settings);},addAnim:function(name,frameTime,sequence,stop){if(!this.animSheet){throw('No animSheet to add the animation '+name+' to.');}
var a=new ig.Animation(this.animSheet,frameTime,sequence,stop);this.anims[name]=a;if(!this.currentAnim){this.currentAnim=a;}
return a;},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;var res=ig.game.collisionMap.trace(this.pos.x,this.pos.y,mx,my,this.size.x,this.size.y);this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}},getNewVelocity:function(vel,accel,friction,max){if(accel){return(vel+accel*ig.system.tick).limit(-max,max);}
else if(friction){var delta=friction*ig.system.tick;if(vel-delta>0){return vel-delta;}
else if(vel+delta<0){return vel+delta;}
else{return 0;}}
return vel.limit(-max,max);},handleMovementTrace:function(res){this.standing=false;if(res.collision.y){if(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity){this.vel.y*=-this.bounciness;}
else{if(this.vel.y>0){this.standing=true;}
this.vel.y=0;}}
if(res.collision.x){if(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity){this.vel.x*=-this.bounciness;}
else{this.vel.x=0;}}
if(res.collision.slope){var s=res.collision.slope;if(this.bounciness>0){var proj=this.vel.x*s.nx+this.vel.y*s.ny;this.vel.x=(this.vel.x-s.nx*proj*2)*this.bounciness;this.vel.y=(this.vel.y-s.ny*proj*2)*this.bounciness;}
else{var lengthSquared=s.x*s.x+s.y*s.y;var dot=(this.vel.x*s.x+this.vel.y*s.y)/lengthSquared;this.vel.x=s.x*dot;this.vel.y=s.y*dot;var angle=Math.atan2(s.x,s.y);if(angle>this.slopeStanding.min&&angle<this.slopeStanding.max){this.standing=true;}}}
this.pos=res.pos;},draw:function(){if(this.currentAnim){this.currentAnim.draw(this.pos.x-this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y);}},kill:function(){ig.game.removeEntity(this);},receiveDamage:function(amount,from){this.health-=amount;if(this.health<=0){this.kill();}},touches:function(other){return!(this.pos.x>=other.pos.x+other.size.x||this.pos.x+this.size.x<=other.pos.x||this.pos.y>=other.pos.y+other.size.y||this.pos.y+this.size.y<=other.pos.y);},distanceTo:function(other){var xd=(this.pos.x+this.size.x/2)-(other.pos.x+other.size.x/2);var yd=(this.pos.y+this.size.y/2)-(other.pos.y+other.size.y/2);return Math.sqrt(xd*xd+yd*yd);},angleTo:function(other){return Math.atan2((other.pos.y+other.size.y/2)-(this.pos.y+this.size.y/2),(other.pos.x+other.size.x/2)-(this.pos.x+this.size.x/2));},check:function(other){},collideWith:function(other,axis){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(a,b){if(a.checkAgainst&b.type){a.check(b);}
if(b.checkAgainst&a.type){b.check(a);}
if(a.collides&&b.collides&&a.collides+b.collides>ig.Entity.COLLIDES.ACTIVE){ig.Entity.solveCollision(a,b);}};ig.Entity.solveCollision=function(a,b){var weak=null;if(a.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED){weak=a;}
else if(b.collides==ig.Entity.COLLIDES.LITE||a.collides==ig.Entity.COLLIDES.FIXED){weak=b;}
if(a.last.x+a.size.x>b.last.x&&a.last.x<b.last.x+b.size.x){if(a.last.y<b.last.y){ig.Entity.seperateOnYAxis(a,b,weak);}
else{ig.Entity.seperateOnYAxis(b,a,weak);}
a.collideWith(b,'y');b.collideWith(a,'y');}
else if(a.last.y+a.size.y>b.last.y&&a.last.y<b.last.y+b.size.y){if(a.last.x<b.last.x){ig.Entity.seperateOnXAxis(a,b,weak);}
else{ig.Entity.seperateOnXAxis(b,a,weak);}
a.collideWith(b,'x');b.collideWith(a,'x');}};ig.Entity.seperateOnXAxis=function(left,right,weak){var nudge=(left.pos.x+left.size.x-right.pos.x);if(weak){var strong=left===weak?right:left;weak.vel.x=-weak.vel.x*weak.bounciness+strong.vel.x;var resWeak=ig.game.collisionMap.trace(weak.pos.x,weak.pos.y,weak==left?-nudge:nudge,0,weak.size.x,weak.size.y);weak.pos.x=resWeak.pos.x;}
else{var v2=(left.vel.x-right.vel.x)/2;left.vel.x=-v2;right.vel.x=v2;var resLeft=ig.game.collisionMap.trace(left.pos.x,left.pos.y,-nudge/2,0,left.size.x,left.size.y);left.pos.x=Math.floor(resLeft.pos.x);var resRight=ig.game.collisionMap.trace(right.pos.x,right.pos.y,nudge/2,0,right.size.x,right.size.y);right.pos.x=Math.ceil(resRight.pos.x);}};ig.Entity.seperateOnYAxis=function(top,bottom,weak){var nudge=(top.pos.y+top.size.y-bottom.pos.y);if(weak){var strong=top===weak?bottom:top;weak.vel.y=-weak.vel.y*weak.bounciness+strong.vel.y;var nudgeX=0;if(weak==top&&Math.abs(weak.vel.y-strong.vel.y)<weak.minBounceVelocity){weak.standing=true;nudgeX=strong.vel.x*ig.system.tick;}
var resWeak=ig.game.collisionMap.trace(weak.pos.x,weak.pos.y,nudgeX,weak==top?-nudge:nudge,weak.size.x,weak.size.y);weak.pos.y=resWeak.pos.y;weak.pos.x=resWeak.pos.x;}
else if(ig.game.gravity&&(bottom.standing||top.vel.y>0)){var resTop=ig.game.collisionMap.trace(top.pos.x,top.pos.y,0,-(top.pos.y+top.size.y-bottom.pos.y),top.size.x,top.size.y);top.pos.y=resTop.pos.y;if(top.bounciness>0&&top.vel.y>top.minBounceVelocity){top.vel.y*=-top.bounciness;}
else{top.standing=true;top.vel.y=0;}}
else{var v2=(top.vel.y-bottom.vel.y)/2;top.vel.y=-v2;bottom.vel.y=v2;var nudgeX=bottom.vel.x*ig.system.tick;var resTop=ig.game.collisionMap.trace(top.pos.x,top.pos.y,nudgeX,-nudge/2,top.size.x,top.size.y);top.pos.y=resTop.pos.y;var resBottom=ig.game.collisionMap.trace(bottom.pos.x,bottom.pos.y,0,nudge/2,bottom.size.x,bottom.size.y);bottom.pos.y=resBottom.pos.y;}};});

// lib/impact/map.js
ig.baked=true;ig.module('impact.map').defines(function(){"use strict";ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(tilesize,data){this.tilesize=tilesize;this.data=data;this.height=data.length;this.width=data[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize;},getTile:function(x,y){var tx=Math.floor(x/this.tilesize);var ty=Math.floor(y/this.tilesize);if((tx>=0&&tx<this.width)&&(ty>=0&&ty<this.height)){return this.data[ty][tx];}
else{return 0;}},setTile:function(x,y,tile){var tx=Math.floor(x/this.tilesize);var ty=Math.floor(y/this.tilesize);if((tx>=0&&tx<this.width)&&(ty>=0&&ty<this.height)){this.data[ty][tx]=tile;}}});});

// lib/impact/collision-map.js
ig.baked=true;ig.module('impact.collision-map').requires('impact.map').defines(function(){"use strict";ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(tilesize,data,tiledef){this.parent(tilesize,data);this.tiledef=tiledef||ig.CollisionMap.defaultTileDef;for(var t in this.tiledef){if(t|0>this.lastSlope){this.lastSlope=t|0;}}},trace:function(x,y,vx,vy,objectWidth,objectHeight){var res={collision:{x:false,y:false,slope:false},pos:{x:x,y:y},tile:{x:0,y:0}};var steps=Math.ceil(Math.max(Math.abs(vx),Math.abs(vy))/this.tilesize);if(steps>1){var sx=vx/steps;var sy=vy/steps;for(var i=0;i<steps&&(sx||sy);i++){this._traceStep(res,x,y,sx,sy,objectWidth,objectHeight,vx,vy,i);x=res.pos.x;y=res.pos.y;if(res.collision.x){sx=0;vx=0;}
if(res.collision.y){sy=0;vy=0;}
if(res.collision.slope){break;}}}
else{this._traceStep(res,x,y,vx,vy,objectWidth,objectHeight,vx,vy,0);}
return res;},_traceStep:function(res,x,y,vx,vy,width,height,rvx,rvy,step){res.pos.x+=vx;res.pos.y+=vy;var t=0;if(vx){var pxOffsetX=(vx>0?width:0);var tileOffsetX=(vx<0?this.tilesize:0);var firstTileY=Math.max(Math.floor(y/this.tilesize),0);var lastTileY=Math.min(Math.ceil((y+height)/this.tilesize),this.height);var tileX=Math.floor((res.pos.x+pxOffsetX)/this.tilesize);var prevTileX=Math.floor((x+pxOffsetX)/this.tilesize);if(step>0||tileX==prevTileX||prevTileX<0||prevTileX>=this.width){prevTileX=-1;}
if(tileX>=0&&tileX<this.width){for(var tileY=firstTileY;tileY<lastTileY;tileY++){if(prevTileX!=-1){t=this.data[tileY][prevTileX];if(t>1&&t<=this.lastSlope&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,prevTileX,tileY)){break;}}
t=this.data[tileY][tileX];if(t==1||t>this.lastSlope||(t>1&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,tileY))){if(t>1&&t<=this.lastSlope&&res.collision.slope){break;}
res.collision.x=true;res.tile.x=t;x=res.pos.x=tileX*this.tilesize-pxOffsetX+tileOffsetX;rvx=0;break;}}}}
if(vy){var pxOffsetY=(vy>0?height:0);var tileOffsetY=(vy<0?this.tilesize:0);var firstTileX=Math.max(Math.floor(res.pos.x/this.tilesize),0);var lastTileX=Math.min(Math.ceil((res.pos.x+width)/this.tilesize),this.width);var tileY=Math.floor((res.pos.y+pxOffsetY)/this.tilesize);var prevTileY=Math.floor((y+pxOffsetY)/this.tilesize);if(step>0||tileY==prevTileY||prevTileY<0||prevTileY>=this.height){prevTileY=-1;}
if(tileY>=0&&tileY<this.height){for(var tileX=firstTileX;tileX<lastTileX;tileX++){if(prevTileY!=-1){t=this.data[prevTileY][tileX];if(t>1&&t<=this.lastSlope&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,prevTileY)){break;}}
t=this.data[tileY][tileX];if(t==1||t>this.lastSlope||(t>1&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,tileY))){if(t>1&&t<=this.lastSlope&&res.collision.slope){break;}
res.collision.y=true;res.tile.y=t;res.pos.y=tileY*this.tilesize-pxOffsetY+tileOffsetY;break;}}}}},_checkTileDef:function(res,t,x,y,vx,vy,width,height,tileX,tileY){var def=this.tiledef[t];if(!def){return false;}
var lx=(tileX+def[0])*this.tilesize,ly=(tileY+def[1])*this.tilesize,lvx=(def[2]-def[0])*this.tilesize,lvy=(def[3]-def[1])*this.tilesize,solid=def[4];var tx=x+vx+(lvy<0?width:0)-lx,ty=y+vy+(lvx>0?height:0)-ly;if(lvx*ty-lvy*tx>0){if(vx*-lvy+vy*lvx<0){return solid;}
var length=Math.sqrt(lvx*lvx+lvy*lvy);var nx=lvy/length,ny=-lvx/length;var proj=tx*nx+ty*ny;var px=nx*proj,py=ny*proj;if(px*px+py*py>=vx*vx+vy*vy){return solid||(lvx*(ty-vy)-lvy*(tx-vx)<0.5);}
res.pos.x=x+vx-px;res.pos.y=y+vy-py;res.collision.slope={x:lvx,y:lvy,nx:nx,ny:ny};return true;}
return false;}});var H=1/2,N=1/3,M=2/3,SOLID=true,NON_SOLID=false;ig.CollisionMap.defaultTileDef={5:[0,1,1,M,SOLID],6:[0,M,1,N,SOLID],7:[0,N,1,0,SOLID],3:[0,1,1,H,SOLID],4:[0,H,1,0,SOLID],2:[0,1,1,0,SOLID],10:[H,1,1,0,SOLID],21:[0,1,H,0,SOLID],32:[M,1,1,0,SOLID],43:[N,1,M,0,SOLID],54:[0,1,N,0,SOLID],27:[0,0,1,N,SOLID],28:[0,N,1,M,SOLID],29:[0,M,1,1,SOLID],25:[0,0,1,H,SOLID],26:[0,H,1,1,SOLID],24:[0,0,1,1,SOLID],11:[0,0,H,1,SOLID],22:[H,0,1,1,SOLID],33:[0,0,N,1,SOLID],44:[N,0,M,1,SOLID],55:[M,0,1,1,SOLID],16:[1,N,0,0,SOLID],17:[1,M,0,N,SOLID],18:[1,1,0,M,SOLID],14:[1,H,0,0,SOLID],15:[1,1,0,H,SOLID],13:[1,1,0,0,SOLID],8:[H,1,0,0,SOLID],19:[1,1,H,0,SOLID],30:[N,1,0,0,SOLID],41:[M,1,N,0,SOLID],52:[1,1,M,0,SOLID],38:[1,M,0,1,SOLID],39:[1,N,0,M,SOLID],40:[1,0,0,N,SOLID],36:[1,H,0,1,SOLID],37:[1,0,0,H,SOLID],35:[1,0,0,1,SOLID],9:[1,0,H,1,SOLID],20:[H,0,0,1,SOLID],31:[1,0,M,1,SOLID],42:[M,0,N,1,SOLID],53:[N,0,0,1,SOLID],12:[0,0,1,0,NON_SOLID],23:[1,1,0,1,NON_SOLID],34:[1,0,1,1,NON_SOLID],45:[0,1,0,0,NON_SOLID]};ig.CollisionMap.staticNoCollision={trace:function(x,y,vx,vy){return{collision:{x:false,y:false,slope:false},pos:{x:x+vx,y:y+vy},tile:{x:0,y:0}};}};});

// lib/impact/background-map.js
ig.baked=true;ig.module('impact.background-map').requires('impact.map','impact.image').defines(function(){"use strict";ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:false,tilesetName:'',foreground:false,enabled:true,preRender:false,preRenderedChunks:null,chunkSize:512,debugChunks:false,anims:{},init:function(tilesize,data,tileset){this.parent(tilesize,data);this.setTileset(tileset);},setTileset:function(tileset){this.tilesetName=tileset instanceof ig.Image?tileset.path:tileset;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null;},setScreenPos:function(x,y){this.scroll.x=x/this.distance;this.scroll.y=y/this.distance;},preRenderMapToChunks:function(){var totalWidth=this.width*this.tilesize*ig.system.scale,totalHeight=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(totalWidth,totalHeight),this.chunkSize);var chunkCols=Math.ceil(totalWidth/this.chunkSize),chunkRows=Math.ceil(totalHeight/this.chunkSize);this.preRenderedChunks=[];for(var y=0;y<chunkRows;y++){this.preRenderedChunks[y]=[];for(var x=0;x<chunkCols;x++){var chunkWidth=(x==chunkCols-1)?totalWidth-x*this.chunkSize:this.chunkSize;var chunkHeight=(y==chunkRows-1)?totalHeight-y*this.chunkSize:this.chunkSize;this.preRenderedChunks[y][x]=this.preRenderChunk(x,y,chunkWidth,chunkHeight);}}},preRenderChunk:function(cx,cy,w,h){var tw=w/this.tilesize/ig.system.scale+1,th=h/this.tilesize/ig.system.scale+1;var nx=(cx*this.chunkSize/ig.system.scale)%this.tilesize,ny=(cy*this.chunkSize/ig.system.scale)%this.tilesize;var tx=Math.floor(cx*this.chunkSize/this.tilesize/ig.system.scale),ty=Math.floor(cy*this.chunkSize/this.tilesize/ig.system.scale);var chunk=ig.$new('canvas');chunk.width=w;chunk.height=h;chunk.retinaResolutionEnabled=false;var chunkContext=chunk.getContext('2d');ig.System.scaleMode(chunk,chunkContext);var screenContext=ig.system.context;ig.system.context=chunkContext;for(var x=0;x<tw;x++){for(var y=0;y<th;y++){if(x+tx<this.width&&y+ty<this.height){var tile=this.data[y+ty][x+tx];if(tile){this.tiles.drawTile(x*this.tilesize-nx,y*this.tilesize-ny,tile-1,this.tilesize);}}}}
ig.system.context=screenContext;return chunk;},draw:function(){if(!this.tiles.loaded||!this.enabled){return;}
if(this.preRender){this.drawPreRendered();}
else{this.drawTiled();}},drawPreRendered:function(){if(!this.preRenderedChunks){this.preRenderMapToChunks();}
var dx=ig.system.getDrawPos(this.scroll.x),dy=ig.system.getDrawPos(this.scroll.y);if(this.repeat){var w=this.width*this.tilesize*ig.system.scale;dx=(dx%w+w)%w;var h=this.height*this.tilesize*ig.system.scale;dy=(dy%h+h)%h;}
var minChunkX=Math.max(Math.floor(dx/this.chunkSize),0),minChunkY=Math.max(Math.floor(dy/this.chunkSize),0),maxChunkX=Math.ceil((dx+ig.system.realWidth)/this.chunkSize),maxChunkY=Math.ceil((dy+ig.system.realHeight)/this.chunkSize),maxRealChunkX=this.preRenderedChunks[0].length,maxRealChunkY=this.preRenderedChunks.length;if(!this.repeat){maxChunkX=Math.min(maxChunkX,maxRealChunkX);maxChunkY=Math.min(maxChunkY,maxRealChunkY);}
var nudgeY=0;for(var cy=minChunkY;cy<maxChunkY;cy++){var nudgeX=0;for(var cx=minChunkX;cx<maxChunkX;cx++){var chunk=this.preRenderedChunks[cy%maxRealChunkY][cx%maxRealChunkX];var x=-dx+cx*this.chunkSize-nudgeX;var y=-dy+cy*this.chunkSize-nudgeY;ig.system.context.drawImage(chunk,x,y);ig.Image.drawCount++;if(this.debugChunks){ig.system.context.strokeStyle='#f0f';ig.system.context.strokeRect(x,y,this.chunkSize,this.chunkSize);}
if(this.repeat&&chunk.width<this.chunkSize&&x+chunk.width<ig.system.realWidth){nudgeX+=this.chunkSize-chunk.width;maxChunkX++;}}
if(this.repeat&&chunk.height<this.chunkSize&&y+chunk.height<ig.system.realHeight){nudgeY+=this.chunkSize-chunk.height;maxChunkY++;}}},drawTiled:function(){var tile=0,anim=null,tileOffsetX=(this.scroll.x/this.tilesize).toInt(),tileOffsetY=(this.scroll.y/this.tilesize).toInt(),pxOffsetX=this.scroll.x%this.tilesize,pxOffsetY=this.scroll.y%this.tilesize,pxMinX=-pxOffsetX-this.tilesize,pxMinY=-pxOffsetY-this.tilesize,pxMaxX=ig.system.width+this.tilesize-pxOffsetX,pxMaxY=ig.system.height+this.tilesize-pxOffsetY;for(var mapY=-1,pxY=pxMinY;pxY<pxMaxY;mapY++,pxY+=this.tilesize){var tileY=mapY+tileOffsetY;if(tileY>=this.height||tileY<0){if(!this.repeat){continue;}
tileY=(tileY%this.height+this.height)%this.height;}
for(var mapX=-1,pxX=pxMinX;pxX<pxMaxX;mapX++,pxX+=this.tilesize){var tileX=mapX+tileOffsetX;if(tileX>=this.width||tileX<0){if(!this.repeat){continue;}
tileX=(tileX%this.width+this.width)%this.width;}
if((tile=this.data[tileY][tileX])){if((anim=this.anims[tile-1])){anim.draw(pxX,pxY);}
else{this.tiles.drawTile(pxX,pxY,tile-1,this.tilesize);}}}}}});});

// lib/impact/game.js
ig.baked=true;ig.module('impact.game').requires('impact.impact','impact.entity','impact.collision-map','impact.background-map').defines(function(){"use strict";ig.Game=ig.Class.extend({clearColor:'#000000',gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:false,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:false,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;ig.game=this;return null;},loadLevel:function(data){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var i=0;i<data.entities.length;i++){var ent=data.entities[i];this.spawnEntity(ent.type,ent.x,ent.y,ent.settings);}
this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(var i=0;i<data.layer.length;i++){var ld=data.layer[i];if(ld.name=='collision'){this.collisionMap=new ig.CollisionMap(ld.tilesize,ld.data);}
else{var newMap=new ig.BackgroundMap(ld.tilesize,ld.data,ld.tilesetName);newMap.anims=this.backgroundAnims[ld.tilesetName]||{};newMap.repeat=ld.repeat;newMap.distance=ld.distance;newMap.foreground=!!ld.foreground;newMap.preRender=!!ld.preRender;newMap.name=ld.name;this.backgroundMaps.push(newMap);}}
for(var i=0;i<this.entities.length;i++){this.entities[i].ready();}},loadLevelDeferred:function(data){this._levelToLoad=data;},getMapByName:function(name){if(name=='collision'){return this.collisionMap;}
for(var i=0;i<this.backgroundMaps.length;i++){if(this.backgroundMaps[i].name==name){return this.backgroundMaps[i];}}
return null;},getEntityByName:function(name){return this.namedEntities[name];},getEntitiesByType:function(type){var entityClass=typeof(type)==='string'?ig.global[type]:type;var a=[];for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(ent instanceof entityClass&&!ent._killed){a.push(ent);}}
return a;},spawnEntity:function(type,x,y,settings){var entityClass=typeof(type)==='string'?ig.global[type]:type;if(!entityClass){throw("Can't spawn entity of type "+type);}
var ent=new(entityClass)(x,y,settings||{});this.entities.push(ent);if(ent.name){this.namedEntities[ent.name]=ent;}
return ent;},sortEntities:function(){this.entities.sort(this.sortBy);},sortEntitiesDeferred:function(){this._doSortEntities=true;},removeEntity:function(ent){if(ent.name){delete this.namedEntities[ent.name];}
ent._killed=true;ent.type=ig.Entity.TYPE.NONE;ent.checkAgainst=ig.Entity.TYPE.NONE;ent.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(ent);},run:function(){this.update();this.draw();},update:function(){if(this._levelToLoad){this.loadLevel(this._levelToLoad);this._levelToLoad=null;}
this.updateEntities();this.checkEntities();for(var i=0;i<this._deferredKill.length;i++){this._deferredKill[i].erase();this.entities.erase(this._deferredKill[i]);}
this._deferredKill=[];if(this._doSortEntities||this.autoSort){this.sortEntities();this._doSortEntities=false;}
for(var tileset in this.backgroundAnims){var anims=this.backgroundAnims[tileset];for(var a in anims){anims[a].update();}}},updateEntities:function(){for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(!ent._killed){ent.update();}}},draw:function(){if(this.clearColor){ig.system.clear(this.clearColor);}
this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var mapIndex;for(mapIndex=0;mapIndex<this.backgroundMaps.length;mapIndex++){var map=this.backgroundMaps[mapIndex];if(map.foreground){break;}
map.setScreenPos(this.screen.x,this.screen.y);for(var e=0;e<this.entities.length;e++){var ent=this.entities[e];if(typeof(ent.drawBeforeLayer)!='undefined'&&ent.drawBeforeLayer==mapIndex){ent.draw();}}
map.draw();}
this.drawEntities();for(mapIndex;mapIndex<this.backgroundMaps.length;mapIndex++){var map=this.backgroundMaps[mapIndex];map.setScreenPos(this.screen.x,this.screen.y);map.draw();}},drawEntities:function(){for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(typeof(ent.drawBeforeLayer)=='undefined'){ent.draw();}}},checkEntities:function(){var hash={};for(var e=0;e<this.entities.length;e++){var entity=this.entities[e];if(entity.type==ig.Entity.TYPE.NONE&&entity.checkAgainst==ig.Entity.TYPE.NONE&&entity.collides==ig.Entity.COLLIDES.NEVER){continue;}
var checked={},xmin=Math.floor(entity.pos.x/this.cellSize),ymin=Math.floor(entity.pos.y/this.cellSize),xmax=Math.floor((entity.pos.x+entity.size.x)/this.cellSize)+1,ymax=Math.floor((entity.pos.y+entity.size.y)/this.cellSize)+1;for(var x=xmin;x<xmax;x++){for(var y=ymin;y<ymax;y++){if(!hash[x]){hash[x]={};hash[x][y]=[entity];}
else if(!hash[x][y]){hash[x][y]=[entity];}
else{var cell=hash[x][y];for(var c=0;c<cell.length;c++){if(entity.touches(cell[c])&&!checked[cell[c].id]){checked[cell[c].id]=true;ig.Entity.checkPair(entity,cell[c]);}}
cell.push(entity);}}}}}});ig.Game.SORT={Z_INDEX:function(a,b){return a.zIndex-b.zIndex;},POS_X:function(a,b){return(a.pos.x+a.size.x)-(b.pos.x+b.size.x);},POS_Y:function(a,b){return(a.pos.y+a.size.y)-(b.pos.y+b.size.y);}};});

// lib/impact/entity-pool.js
ig.baked=true;ig.module('impact.entity-pool').requires('impact.game').defines(function(){"use strict";ig.EntityPool={pools:{},mixin:{staticInstantiate:function(x,y,settings){return ig.EntityPool.getFromPool(this.classId,x,y,settings);},erase:function(){ig.EntityPool.putInPool(this);}},enableFor:function(Class){Class.inject(this.mixin);},getFromPool:function(classId,x,y,settings){var pool=this.pools[classId];if(!pool||!pool.length){return null;}
var instance=pool.pop();instance.reset(x,y,settings);return instance;},putInPool:function(instance){if(!this.pools[instance.classId]){this.pools[instance.classId]=[instance];}
else{this.pools[instance.classId].push(instance);}},drainPool:function(classId){delete this.pools[classId];},drainAllPools:function(){this.pools={};}};ig.Game.inject({loadLevel:function(data){ig.EntityPool.drainAllPools();this.parent(data);}});});

// lib/game/entities/particle.js
ig.baked=true;ig.module('game.entities.particle').requires('impact.entity','impact.entity-pool').defines(function(){EntityParticle=ig.Entity.extend({_wmIgnore:true,size:{x:4,y:4},offset:{x:0,y:0},maxVel:{x:160,y:160},minBounceVelocity:0,zIndex:50,type:ig.Entity.TYPE.NONE,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.LITE,lifetime:3,fadetime:1,bounciness:0.6,friction:{x:20,y:0},allowFlipX:true,allowFlipY:true,init:function(x,y,settings){this.parent(x,y,settings);this.vel.x=(Math.random()*2-1)*this.vel.x;this.vel.y=(Math.random()*2-1)*this.vel.y;if(this.allowFlipX)this.currentAnim.flip.x=(Math.random()>0.5);if(this.allowFlipY)this.currentAnim.flip.y=(Math.random()>0.5);this.currentAnim.gotoRandomFrame();this.idleTimer=new ig.Timer();},reset:function(x,y,settings){this.parent(x,y,settings);this.vel.x=(Math.random()*2-1)*this.vel.x;this.vel.y=(Math.random()*2-1)*this.vel.y;this.currentAnim.flip.x=(Math.random()>0.5);this.currentAnim.flip.y=(Math.random()>0.5);this.currentAnim.gotoRandomFrame();this.idleTimer=new ig.Timer();},update:function(){if(this.idleTimer.delta()>this.lifetime){this.kill();return;}
this.currentAnim.alpha=this.idleTimer.delta().map(this.lifetime-this.fadetime,this.lifetime,1,0);this.parent();}});});

// lib/game/entities/bullet-chunks.js
ig.baked=true;ig.module('game.entities.bullet-chunks').requires('impact.entity','game.entities.particle').defines(function(){EntityBulletChunks=ig.Entity.extend({size:{x:0,y:5},instances:[],maxInstances:10,minInstances:3,numInstances:0,init:function(x,y,settings){this.parent(x,y,settings);this.numInstances=ig.game.random.range(this.minInstances,this.maxInstances);},update:function(){if(this.instances.length<this.numInstances){var x=Math.random().map(0,1,this.pos.x,this.pos.x+this.size.x);var y=Math.random().map(0,1,this.pos.y,this.pos.y+this.size.y);instance=ig.game.spawnEntity(EntityDebrisParticle,x,y);this.instances.push(instance);}else{this.kill();}}});EntityDebrisParticle=EntityParticle.extend({_wmIgnore:true,lifetime:3,fadetime:1,bounciness:0.5,vel:{x:60,y:10},friction:{x:40,y:40},animSheet:new ig.AnimationSheet('media/effects/chunks.png',6,6),init:function(x,y,settings){this.addAnim('idle',5,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]);this.parent(x,y,settings);},reset:function(x,y,settings){this.addAnim('idle',5,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]);this.parent(x,y,settings);}});ig.EntityPool.enableFor(EntityDebrisParticle);});

// lib/game/entities/projectile.js
ig.baked=true;ig.module('game.entities.projectile').requires('impact.entity','impact.entity-pool','game.entities.bullet-chunks').defines(function(){EntityProjectile=ig.Entity.extend({_wmIgnore:true,size:{x:24,y:24},offset:{x:6,y:6},maxVel:{x:600,y:600},gravityFactor:0,removeIfOffScreen:true,type:"bullet",type:ig.Entity.TYPE.NONE,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.PASSIVE,damage:1,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0]);this.vel={x:this.maxVel.x*settings.direction.x,y:this.maxVel.y*settings.direction.y};},reset:function(x,y,settings){this.parent(x,y,settings);this.vel={x:this.maxVel.x*settings.direction.x,y:this.maxVel.y*settings.direction.y};},update:function(){if(this.type!="beam"){if(!this.checkOnScreen())this.kill();}
this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);if(this.vel.x<0){this.currentAnim.flip.x=true;}else{this.currentAnim.flip.x=false;}
if(this.vel.y>0){this.currentAnim.flip.y=true;}else{this.currentAnim.flip.y=false;}
var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;var res={collision:{x:false,y:false},pos:{x:this.pos.x+mx,y:this.pos.y+my},tile:{x:0,y:0}};this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}},handleMovementTrace:function(res){this.parent(res);},check:function(other){ig.game.spawnEntity(EntityBulletChunks,this.pos.x+this.size.x,this.pos.y+this.size.y*0.5,{});other.receiveDamage(this.damage,this);if(!isNaN(other.score_hit))ig.game.player.addToScore(other.score_hit*ig.game.difficultyManager.cycle*ig.game.player.multiplier);this.kill();},checkOnScreen:function(){var px=this.pos.x,py=this.pos.y,hasSheet=(this.currentAnim)?true:false,padding=10;return(px>ig.game.screen.x-padding&&px<=ig.game.screen.x+ig.system.width)&&(py>ig.game.screen.y&&py<ig.game.screen.y+ig.system.height)?true:false;},offsetBullet:function(x,y,settings){var offsets={};if(settings.direction.y!=0&&settings.direction.x!=0){if(settings.flip){offsets.x=this.fireOffset.angle.xFlip;}else{offsets.x=this.fireOffset.angle.x;}
if(settings.direction.y>0){offsets.y=this.fireOffset.angle.yFlip;}else{offsets.y=this.fireOffset.angle.y;}}else if(settings.direction.y==0&&settings.direction.x!=0){if(settings.flip){offsets.x=this.fireOffset.idle.xFlip;}else{offsets.x=this.fireOffset.idle.x;}
if(settings.direction.y>0){offsets.y=this.fireOffset.idle.yFlip;}else{offsets.y=this.fireOffset.idle.y;}}else if(settings.direction.y!=0&&settings.direction.x==0){if(settings.flip){offsets.x=this.fireOffset.vertical.xFlip;}else{offsets.x=this.fireOffset.vertical.x;}
if(settings.direction.y>0){offsets.y=this.fireOffset.vertical.yFlip;}else{offsets.y=this.fireOffset.vertical.y;}}
return offsets;},pointBullet:function(x,y,settings){if(settings.direction.y!=0&&settings.direction.x!=0){this.currentAnim=this.anims["angled"];}else if(settings.direction.y==0&&settings.direction.x!=0){this.currentAnim=this.anims["idle"];}else if(settings.direction.y!=0&&settings.direction.x==0){this.currentAnim=this.anims["vertical"];}}});ig.EntityPool.enableFor(EntityProjectile);});

// lib/game/entities/bullet.js
ig.baked=true;ig.module('game.entities.bullet').requires('game.entities.projectile').defines(function(){EntityBullet=EntityProjectile.extend({_wmIgnore:true,size:{x:24,y:24},offset:{x:6,y:0},maxVel:{x:600,y:600},zIndex:110,fireOffset:{idle:{x:35,xFlip:0,y:37,yFlip:15},angle:{x:25,xFlip:15,y:20,yFlip:50},vertical:{x:16,xFlip:30,y:0,yFlip:30}},animSheet:new ig.AnimationSheet('media/weapons/Hero_MachineGun_Bullet_Lg_Sprite.png',13,13),damage:1,init:function(x,y,settings){var offsets=this.offsetBullet(x,y,settings);x+=offsets.x;y+=offsets.y;this.parent(x,y,settings);this.addAnim('idle',1,[2]);this.addAnim('angled',1,[3]);this.addAnim('vertical',1,[4]);this.pointBullet(x,y,settings);ig.game.sounds.machine_gun.play();},reset:function(x,y,settings){var offsets=this.offsetBullet(x,y,settings);x+=offsets.x;y+=offsets.y;this.parent(x,y,settings);this.pointBullet(x,y,settings);ig.game.sounds.machine_gun.play();},});});

// lib/game/entities/bullet-electro.js
ig.baked=true;ig.module('game.entities.bullet-electro').requires('game.entities.projectile').defines(function(){EntityBulletElectro=EntityProjectile.extend({_wmIgnore:true,size:{x:687,y:70},offset:{x:0,y:0},maxVel:{x:0,y:0},zIndex:110,fireOffset:{idle:{x:47,xFlip:698,y:-5},},endFrameReached:false,endFrame:null,flip:false,type:"beam",animSheet:new ig.AnimationSheet('media/weapons/Hero_Electric_Bullet_Sprite.png',687,70),damage:3,init:function(x,y,settings){this.parent(x,y,settings);this.endFrame=5;this.addAnim('idle',.05,[0,1,2,3,4,5],true);this.currentAnim=this.anims["idle"];this.currentAnim.rewind();if(settings.flip){this.flip=true;}
ig.game.sounds.battery_blast.play();},reset:function(x,y,settings){this.endFrameReached=false;this.endFrame=5;this.parent(x,y,settings);this.currentAnim=this.anims["idle"];this.currentAnim.rewind();if(settings.flip){this.flip=true;}
ig.game.sounds.battery_blast.play();},offsetBullet:function(x,y,settings){var offsets={};if(settings.flip){offsets.x=this.fireOffset.idle.xFlip;}else{offsets.x=this.fireOffset.idle.x;}
offsets.y=this.fireOffset.idle.y;return offsets;},check:function(other){other.receiveDamage(this.damage,this);},update:function(){this.parent();if(ig.game.player.flip){this.currentAnim.flip.x=true;this.pos.x=ig.game.player.pos.x-this.fireOffset.idle.xFlip;}else{this.pos.x=ig.game.player.pos.x+this.fireOffset.idle.x;}
this.pos.y=ig.game.player.pos.y+this.fireOffset.idle.y;if(this.endFrameReached){this.kill();};if(this.currentAnim.frame==this.endFrame){this.endFrameReached=true;};},});});

// lib/game/entities/weapon.js
ig.baked=true;ig.module('game.entities.weapon').requires('impact.entity').defines(function(){EntityWeapon=ig.Entity.extend({_wmIgnore:true,size:{x:25,y:50},offset:{x:0,y:0},maxVel:{x:300,y:500},friction:{x:2000,y:0},collides:ig.Entity.COLLIDES.NEVER,animSheet:new ig.AnimationSheet('media/weapons/weaponplaceholder.png',32,16),player:null,zIndex:101,direction:"horizontal",horizontalLock:false,flipOffset:0,weaponData:{offset:{x:0,y:0}},init:function(x,y,settings){this.parent(x,y,settings);this.player=settings.player;},blinkAllAnimations:function(alpha){for(var anim in this.anims){this.anims[anim].alpha=alpha;}},setWeapon:function(data,settings){this.weaponData=data;this.horizontalLock=settings.horizontalLock;for(var i=0;i<data.animations.length;i++){this.addAnim(data.animations[i].name,data.animations[i].framerate,data.animations[i].frames,data.animations[i].stop);}
this.swapSheets(data.animSheet);this.flipOffset=data.flipOffset;},fire:function(data){this.currentAnim=this.anims[this.direction+"-shooting"];},ease:function(){this.currentAnim=this.anims[this.direction+"-idle"];},setDirection:function(direction){if(direction.x==0){if(direction.y<0){this.direction="verticalUp";}else if(direction.y>0){this.direction="verticalDown";}else{this.direction="horizontal";}}else{if(direction.y<0){this.direction="angleUp";}else if(direction.y>0){this.direction="angleDown";}else{this.direction="horizontal";}}
if(this.horizontalLock){this.direction="horizontal";}
this.currentAnim=this.anims[this.direction+"-idle"];},swapSheets:function(sheet){_.each(this.anims,function(o){o.sheet=sheet;},this);},update:function(){this.parent();this.currentAnim.flip.x=this.player.flip;if(this.player.flip){this.pos.x=this.player.pos.x-this.weaponData.offset.x-this.flipOffset;this.pos.y=this.player.pos.y+this.weaponData.offset.y;}else{this.pos.x=this.player.pos.x+this.weaponData.offset.x;this.pos.y=this.player.pos.y+this.weaponData.offset.y;}},kill:function(){this.parent();},});});

// lib/game/classes/arsenal.js
ig.baked=true;ig.module('game.classes.arsenal').requires('impact.game','game.entities.bullet','game.entities.bullet-electro','game.entities.weapon').defines(function(){Arsenal=ig.Class.extend({player:null,weaponEntity:null,weapons:[{name:"Machine Gun",horizontalLock:false,entity:EntityBullet,shootTimer:new ig.Timer(),rate:.08,animationInfo:{animSheet:new ig.AnimationSheet('media/weapons/Hero_MachineGun_Sprite.png',45,80),animations:[{name:"horizontal-idle",framerate:1,frames:[4],stop:true,},{name:"verticalUp-idle",framerate:1,frames:[8],stop:true,},{name:"verticalDown-idle",framerate:1,frames:[0],stop:true,},{name:"angleUp-idle",framerate:1,frames:[6],stop:true,},{name:"angleDown-idle",framerate:1,frames:[2],stop:true,},{name:"horizontal-shooting",framerate:.05,frames:[4,5],stop:false,},{name:"verticalUp-shooting",framerate:.05,frames:[8,9],stop:false,},{name:"verticalDown-shooting",framerate:.05,frames:[0,1],stop:false,},{name:"angleUp-shooting",framerate:.05,frames:[6,7],stop:false,},{name:"angleDown-shooting",framerate:.05,frames:[2,3],stop:false,}],offset:{x:3,y:-17},flipOffset:10,}},{name:"Battery Blast",horizontalLock:true,entity:EntityBulletElectro,shootTimer:new ig.Timer(),rate:3,animationInfo:{animSheet:new ig.AnimationSheet('media/weapons/Hero_BatteryGun_Sprite.png',59,82),animations:[{name:"horizontal-idle",framerate:1,frames:[4],stop:true,},{name:"verticalUp-idle",framerate:1,frames:[8],stop:true,},{name:"verticalDown-idle",framerate:1,frames:[0],stop:true,},{name:"angleUp-idle",framerate:1,frames:[6],stop:true,},{name:"angleDown-idle",framerate:1,frames:[2],stop:true,},{name:"horizontal-shooting",framerate:.05,frames:[4,5],stop:false,},{name:"verticalUp-shooting",framerate:.05,frames:[8,9],stop:false,},{name:"verticalDown-shooting",framerate:.05,frames:[0,1],stop:false,},{name:"angleUp-shooting",framerate:.05,frames:[6,7],stop:false,},{name:"angleDown-shooting",framerate:.05,frames:[2,3],stop:false,}],offset:{x:-5,y:-16},flipOffset:23,}},],active:null,last:null,shootTimer:null,init:function(settings){this.player=settings.player;this.active=this.weapons[0];this.last=this.weapons[1];if(!ig.global.wm){this.weaponEntity=ig.game.spawnEntity(EntityWeapon,this.player.pos.x,this.player.pos.y,{"player":this.player});this.weaponEntity.setWeapon(this.active.animationInfo,{"horizontalLock":this.active.horizontalLock});}
ig.input.bind(ig.KEY._1,'weapon_1');ig.input.bind(ig.KEY._2,'weapon_2');ig.input.bind(ig.KEY.Q,'weapon_swap');},fire:function(direction){var entity=this.active.entity;if(this.active.shootTimer.delta()>0){ig.game.spawnEntity(entity,this.weaponEntity.pos.x,this.weaponEntity.pos.y,{direction:{x:direction.x,y:direction.y},flip:this.player.currentAnim.flip.x});this.active.shootTimer.set(this.active.rate);}
this.weaponEntity.setDirection({x:direction.x,y:direction.y});this.weaponEntity.fire();},atEase:function(){this.weaponEntity.setDirection({x:0,y:0});this.weaponEntity.ease();},activate:function(weapon){if(weapon!=this.active){this.last=this.active;this.active=weapon;this.weaponEntity.setWeapon(this.active.animationInfo,{"horizontalLock":this.active.horizontalLock});}},handleEvents:function(){if(ig.game.controlEnabled){if(ig.input.pressed('weapon_1')){this.activate(this.weapons[0]);}else if(ig.input.pressed('weapon_2')){this.activate(this.weapons[1]);}else if(ig.input.pressed('weapon_swap')){this.activate(this.last);}}},kill:function(){this.weaponEntity.kill();}});});﻿

// lib/plugins/impactEvents.js
ig.baked=true;ig.module('plugins.impactEvents').requires('impact.game').defines(function(){ig.Game.prototype._publishers={};ig.Game.prototype.addListener=function(publisher,event,callback){if(!publisher._uniqueId){publisher._uniqueId=ig.game._nextId();}
if(!this._publishers[publisher._uniqueId]){this._publishers[publisher._uniqueId]={};}
if(!this._publishers[publisher._uniqueId][event]||!(this._publishers[publisher._uniqueId][event]instanceof Array)){this._publishers[publisher._uniqueId][event]=[];}
var nextId=ig.game._nextId();this._publishers[publisher._uniqueId][event].push({callback:callback,uniqueId:nextId});return nextId;};ig.Game.prototype.fire=function(publisher,event){if(this._publishers!==undefined&&this._publishers[publisher._uniqueId]!==undefined){var invokeList=[];for(var i=0;i<this._publishers[publisher._uniqueId][event].length;i++){invokeList.push(this._publishers[publisher._uniqueId][event][i].callback);}
for(var i=0;i<invokeList.length;i++){if(arguments[2]!==null&&arguments[2]!=="undefined"){invokeList[i](arguments[2]);}
else{invokeList[i]();}}
delete invokeList;}};ig.Game.prototype.removeListener=function(publisher,event,uniqueId){if(this._publishers!==undefined&&this._publishers[publisher._uniqueId]!==undefined){for(var i=0;i<this._publishers[publisher._uniqueId][event].length;i++){if(this._publishers[publisher._uniqueId][event][i].uniqueId===uniqueId){this._publishers[publisher._uniqueId][event].splice(i,1);break;}}}}
ig.Game.prototype._nextId=function(){if(!this._uniqueId){this._uniqueId=0;}
return this._uniqueId++;};ig.Entity.prototype.addListener=function(event,callback){return ig.game.addListener(this,event,callback);};ig.Entity.prototype.removeListener=function(event,uniqueAttachment){ig.game.removeListener(this,event,uniqueAttachment);}
ig.Entity.prototype.fire=function(event){if(arguments[1]!==null&&arguments[1]!=="undefined"){ig.game.fire(this,event,arguments[1]);}
else{ig.game.fire(this,event);}};ig.Entity.inject({kill:function(){this.parent();if(ig.game._publishers!==undefined&&this._uniqueId>0&&ig.game._publishers[this._uniqueId]!==undefined){delete ig.game._publishers[this._uniqueId];}}});ig.Animation.prototype.onComplete=function(callback){var uniqueId=ig.game.addListener(this,"complete",callback);var completeData={loopCount:this.loopCount,uniqueId:uniqueId};if(this._completeData===undefined||typeof(this._completeData)!=="array"){this._completeData=[];}
this._completeData.push(completeData);return uniqueId;}
ig.Animation.prototype.onKeyframe=function(keyframe,callback){var uniqueId=ig.game.addListener(this,"onKeyframe"+keyframe,callback);var onKeyframe={loopCount:this.loopCount,keyframe:keyframe,uniqueId:uniqueId};if(this._keyframeData===undefined||typeof(this._keyframeData)!=="array"){this._keyframeData=[];}
this._keyframeData.push(onKeyframe);return uniqueId;}
ig.Animation.inject({update:function(){this.parent();if(this._completeData&&this._completeData.length>0){for(var i=0;i<this._completeData.length;i++){if(this.loopCount>this._completeData[i].loopCount){try{ig.game.fire(this,"complete");}
finally{ig.game.removeListener(this,"complete",this._completeData[i].uniqueId);}}}}
if(this._keyframeData&&this._keyframeData.length>0){for(var i=0;i<this._keyframeData.length;i++){if(this.frame>=this._keyframeData[i].keyframe){try{ig.game.fire(this,"onKeyframe"+this._keyframeData[i].keyframe);}
finally{ig.game.removeListener(this,"onKeyframe"+this._keyframeData[i].keyframe,this._keyframeData[i].uniqueId);}}}}}});});

// lib/game/entities/textplayer.js
ig.baked=true;ig.module('game.entities.textplayer').requires('impact.entity','plugins.impactEvents').defines(function(){EntityTextplayer=ig.Entity.extend({_wmDrawBox:true,_wmBoxColor:'rgba(255, 100, 0, 0.7)',size:{x:90,y:90},pos:{x:0,y:0},textString:null,font:null,fontAlignment:ig.Font.ALIGN.LEFT,textStringLength:null,textArray:null,textCurrentChar:1,displayText:'',maxWidth:250,gravityFactor:0,drawX:0,drawY:0,typeDelay:null,refreshTimer:null,framerate:0.02,complete:false,enableSound:true,soundPlaying:false,killTimer:null,duration:null,init:function(x,y,settings){this.parent(x,y,settings);this.textArray=this.textString.split('');this.textStringLength=this.textArray.length;this.typeDelay=new ig.Timer();this.refreshTimer=new ig.Timer();if(this.duration)this.killTimer=new ig.Timer(this.duration);},kill:function(){ig.game.sounds.typing.stop();this.parent();},draw:function(){this.parent();var x=ig.system.width/2;var y=ig.system.height/2;if(this.refreshTimer.delta()>0){if(this.typeDelay.delta()>0){if(this.textCurrentChar<=this.textStringLength){this.displayText='';var lineBreaks=1;var breakChar="null";for(var i=0;i<this.textCurrentChar;i++){this.displayText+=this.textArray[i];if(!this.soundPlaying&&(this.textArray[i]!=" "&&this.textArray[i+1])!=" "){if(this.enableSound)ig.game.sounds.typing.play();this.soundPlaying=true;}
if(this.textArray[i+1]=="*"){this.typeDelay.set(1);this.textArray.splice(this.textArray.indexOf("*"),1);this.textStringLength--;ig.game.sounds.typing.stop();this.soundPlaying=false;}}
this.textCurrentChar++;}else{ig.game.sounds.typing.stop();}}
this.refreshTimer.set(this.framerate);}
if((this.textArray[this.textCurrentChar]==" "&&this.textArray[this.textCurrentChar+1]==" ")||this.textArray[this.textCurrentChar]=="*"){ig.game.sounds.typing.stop();this.soundPlaying=false;}
this.font.draw(this.displayText,this.drawX,this.drawY,this.fontAlignment);},update:function(){if(!this.complete&&this.textCurrentChar>=this.textStringLength){this.complete=true;this.fire("complete");}
if(this.killTimer){if(this.killTimer.delta()>0)this.kill();}
this.parent();}});});

// lib/game/entities/player.js
ig.baked=true;ig.module('game.entities.player').requires('impact.entity','game.classes.arsenal','game.entities.textplayer').defines(function(){EntityPlayer=ig.Entity.extend({size:{x:25,y:50},offset:{x:0,y:0},maxVel:{x:300,y:500},friction:{x:2000,y:0},type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.PASSIVE,spriteSheets:{hood_up:new ig.AnimationSheet('media/Hero_Sprite.png',35,53),hood_down:new ig.AnimationSheet('media/Hero_HoodDown_Sprite.png',35,53),},health:11,zIndex:100,flip:false,accelGround:1500,accelAir:600,jump:500,maxHealth:11,bullet_vel:{x:0,y:0},score:0,multiplier:1,hardcore:false,arsenal:null,charged:true,state:{intro:true,level:false,ending:false},invincible:false,invincibleTimer:new ig.Timer(),invincibleDuration:1.5,blinking:false,blinkOn:false,blinkTimer:new ig.Timer(),blinkDuration:.15,dead:false,musicStarted:false,special:null,init:function(x,y,settings){this.parent(x,y,settings);this.animSheet=this.spriteSheets['hood_up'];this.addAnim('idle',1,[0]);this.addAnim('run',0.13,[1,2,3,4]);this.addAnim('run_reverse',0.13,[4,3,2,1]);this.addAnim('jump',1,[5]);this.addAnim('hit',0.3,[6],true);this.addAnim('down',1,[7],true);this.addAnim('rescue',0.2,[8,9],true);ig.game.player=this;this.arsenal=new Arsenal({player:this});if(ig.game.servicePacks[0].active){this.hardcore=true;this.health=1;this.multiplier=4;}else{this.hardcore=false;this.health=11;this.multiplier=1;ig.game.servicePacks[0].active=false;}},triggeredBy:function(entity,trigger){if(trigger.name=="jump-trigger"){this.action('soft-jump');}else if(trigger.name=="at-ease-trigger"){this.action('at-ease');}else if(trigger.name=="shoot-left-trigger"){this.action('shoot-left');}else if(trigger.name=="enemy-trigger"){ig.game.sounds.survive.play();setTimeout(function(){ig.game.startWaves();},1000);ig.game.camera.min.x=800;ig.game.camera.max.x=2400;ig.game.hud.lockToCam();ig.game.controlEnabled=true;this.state.intro=false;this.state.level=true;}
ig.game.removeEntity(trigger);},blinkAllAnimations:function(alpha){for(var anim in this.anims){this.anims[anim].alpha=alpha;}
this.arsenal.weaponEntity.blinkAllAnimations(alpha);},update:function(){if(!this.musicStarted){ig.music.play('level_1');this.musicStarted=true;}
if(this.state.intro){var accel=this.standing?this.accelGround:this.accelAir;this.accel.x=accel;}else if(this.state.level){if(ig.game.controlEnabled){this.inputHandler();if(ig.game.servicePacks[0].active&&!this.special){this.special=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:400,drawY:100,textString:ig.game.servicePacks[0].message,font:ig.game.font_console,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.02,duration:4});}}
if(this.invincible){if(this.invincibleTimer.delta()>0){this.invincible=false;this.blinking=false;this.blinkOn=false;this.blinkAllAnimations(1);}}
if(this.blinking){if(this.blinkTimer.delta()>0){if(this.blinkOn==false){this.blinkOn=true;this.blinkAllAnimations(0);}else{this.blinkOn=false;this.blinkAllAnimations(1);}
this.blinkTimer.set(this.blinkDuration);}}}else if(this.state.ending){if(this.vel.y>0&&ig.game.choppa.callForPlayer){ig.game.choppa.state.flyAway=true;ig.game.choppa.state.ending=false;}}
if(this.health<=0){this.kill();}else if(this.currentAnim==this.anims.hit&&this.currentAnim.loopCount<1){}
else if(this.vel.y!=0&&!this.standing){this.currentAnim=this.anims.jump;}else if((this.vel.x>0&&ig.input.state('shoot_left'))||(this.vel.x<0&&ig.input.state("shoot_right"))){this.currentAnim=this.anims.run_reverse;}
else if(this.vel.x!=0){this.currentAnim=this.anims.run;}
else{this.currentAnim=this.anims.idle;}
this.currentAnim.flip.x=this.flip;this.arsenal.handleEvents();if(this.arsenal.weapons[1].shootTimer.delta()<0){this.charged=false;}
else if(!this.charged&&this.arsenal.weapons[1].shootTimer.delta()>0){ig.game.sounds.battery_charge.play();this.charged=true;}
if(this.health<=3&&this.animSheet!=this.spriteSheets['hood_down']){this.swapSheets(this.spriteSheets['hood_down']);}
if(this.state.ending&&ig.game.choppa.state.flyAway){this.vel.y=0;this.pos.x=ig.game.choppa.pos.x+ig.game.choppa.size.x*0.5-15;this.pos.y=ig.game.choppa.pos.y+ig.game.choppa.size.y-2;this.last.x=this.pos.x;this.last.y=this.pos.y;var res={collision:{x:false,y:false},pos:{x:this.pos.x,y:this.pos.y},tile:{x:0,y:0}};this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}}else{this.parent();}},kill:function(){if(!this.state.ending){this.zIndex=-10;this.type=ig.Entity.TYPE.NONE,this.arsenal.kill();this.accel.x=0;ig.game.endingSequence.start();this.state.level=false;this.state.ending=true;this.currentAnim=this.anims.down;}},action:function(action){switch(action){case"jump":this.vel.y=-this.jump;break;case"soft-jump":this.vel.y=-this.jump*.85;break;case"shoot-left":this.bullet_vel.x=-1;this.flip=true;this.arsenal.fire({x:this.bullet_vel.x,y:this.bullet_vel.y});break;case"shoot-right":this.bullet_vel.x=1;this.flip=false;break;case"at-ease":this.flip=false;this.arsenal.atEase();break;}},addToScore:function(value){this.score+=value;},receiveDamage:function(amount,from){if(!ig.game.servicePacks[3].active){if(this.currentAnim==this.anims.hit){return;}
if(this.invincible){return;}
this.health-=amount;this.currentAnim=this.anims.hit.rewind();this.vel.x=(from.pos.x>this.pos.x)?-400:400;this.vel.y=-200;ig.game.sounds.player_hit.play();if(this.health>0&&!this.invincible){this.invincible=true;this.invincibleTimer.set(this.invincibleDuration);this.blinking=true;this.blinkOn=false;this.blinkTimer.set(this.blinkDuration);}}},inputHandler:function(){var accel=this.standing?this.accelGround:this.accelAir;if(ig.input.state('left')){this.accel.x=-accel;this.flip=true;}
else if(ig.input.state('right')){this.accel.x=accel;this.flip=false;}
else{this.accel.x=0;}
if(this.standing&&ig.input.pressed('jump')){this.action('jump');}
if(ig.input.state('shoot_right')){this.action('shoot-right');}else if(ig.input.state('shoot_left')){this.action('shoot-left');}
else this.bullet_vel.x=0;if(ig.input.state('shoot_up'))this.bullet_vel.y=-1;else if(ig.input.state('shoot_down'))this.bullet_vel.y=1;else this.bullet_vel.y=0;if(ig.input.state('shoot_right')||ig.input.state('shoot_left')||ig.input.state('shoot_up')||ig.input.state('shoot_down')){this.arsenal.fire({x:this.bullet_vel.x,y:this.bullet_vel.y});}else{this.arsenal.atEase();}},swapSheets:function(spriteSheet){this.animSheet=spriteSheet;_.each(this.anims,function(o){o.sheet=spriteSheet;},this);}});});

// lib/game/entities/bot-chunks.js
ig.baked=true;ig.module('game.entities.bot-chunks').requires('game.entities.particle').defines(function(){EntityBotChunks=EntityParticle.extend({lifetime:2,fadetime:0.5,bounciness:0.6,vel:{x:50,y:150},friction:{x:40,y:40},size:{x:4,y:4},allowFlipY:false,init:function(x,y,settings){this.animSheet=settings.animSheet;this.size.x=this.animSheet.width;this.size.y=this.animSheet.height-2;this.addAnim('idle',1,settings.animIndex,true);this.parent(x,y,settings);}});});

// lib/game/entities/enemy.js
ig.baked=true;ig.module('game.entities.enemy').requires('impact.entity','game.entities.bot-chunks').defines(function(){EntityEnemy=ig.Entity.extend({maxVel:{x:100,y:360},friction:{x:150,y:0},health:0,baseHealth:0,score_hit:0,score_killed:0,speed:null,speedMin:null,speedMax:null,accelGround:200,accelAir:600,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,removeIfOffScreen:false,flip:false,player:null,jump:500,canJump:true,climbing:false,disableMap:false,collisionDetermined:false,jumpPoint:null,deathSounds:null,xdir:0,roamSet:false,roamMin:1200,roamMax:3500,nextRoamX:null,init:function(x,y,settings){this.parent(x,y,settings);this.disableMap=this.climbing;this.deathSounds=[ig.game.sounds.enemy_death_1,ig.game.sounds.enemy_death_1,ig.game.sounds.enemy_death_2,ig.game.sounds.enemy_death_2];var dirIndex=ig.game.random.range(0,1);if(dirIndex==1)xdir=1;else xdir=-1;},update:function(){this.maxVel.x=this.speed;if(this.climbing){this.currentAnim=this.anims.climb;this.vel.y=this.speed*-1;if(!this.collisionDetermined){this.jumpPoint=ig.game.findCollision(this);this.collisionDetermined=true;}
if(this.pos.y<=this.jumpPoint){this.climberJump();}}else{if(this.currentAnim==this.anims.shoot&&this.currentAnim.loopCount<1){}
else if(this.vel.y!=0){this.currentAnim=this.anims.jump;}else{this.currentAnim=this.anims.walk;}
if(!this.collisionDetermined){this.pos.y=ig.game.findCollision(this)-this.size.y;this.collisionDetermined=true;}
if(!ig.game.player.dead){this.xdir=ig.game.player.pos.x>this.pos.x?1:-1;}else{if(!this.roamSet){this.nextRoamX=ig.game.random.range(this.roamMin,this.roamMax)
this.roamSet=true;if(this.pos.x<this.nextRoamX)this.xdir=1;else this.xdir=-1;}
if((this.xdir==-1&&this.pos.x<this.nextRoamX)||(this.xdir==1&&this.pos.x>this.nextRoamX)){this.roamSet=false;}}
this.flip=this.xdir>0?false:true;var accel=this.accelGround;this.accel.x=accel*this.xdir;this.currentAnim.flip.x=this.flip;}
if(this.pos.y>900){ig.game.removeEntity(this);}
if(this.climbing){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;var res={collision:{x:false,y:false},pos:{x:this.pos.x+mx,y:this.pos.y+my},tile:{x:0,y:0}};this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}}else{this.parent();}},kill:function(){if(!isNaN(this.score_killed)&&!ig.game.enemyFactory.paused)ig.game.player.addToScore(this.score_killed*ig.game.difficultyManager.cycle*ig.game.player.multiplier);this.deathSounds[ig.game.random.range(0,3)].play();this.parent();},spawnChunks:function(amount,sheet){var cx=this.pos.x+this.size.x/2;var cy=this.pos.y+this.size.y/2;for(var i=0;i<amount;i++){var index=this.climbing&&!this.ending?i+amount:i;ig.game.spawnEntity(EntityBotChunks,cx,cy,{animSheet:sheet,animIndex:[index]});}},handleMovementTrace:function(res){this.parent(res);if(res.collision.x&&this.canJump){this.canJump=false;this.vel.y=-this.jump;}
if(res.collision.y&&!this.canJump){this.canJump=true;}},climberJump:function(){this.climbing=false;this.canJump=false;this.vel.y=-this.jump;},check:function(other){if(other==ig.game.choppa){this.receiveDamage(1,this);}else if(ig.game.choppa){if(other==ig.game.choppa.props){this.receiveDamage(1,this);}else{other.receiveDamage(1,this);}}else{other.receiveDamage(1,this);}}});});

// lib/game/entities/enemy-recycle-bin.js
ig.baked=true;ig.module('game.entities.enemy-recycle-bin').requires('game.entities.enemy').defines(function(){EntityEnemyRecycleBin=EntityEnemy.extend({animSheet:new ig.AnimationSheet('media/Recycle_Sprite.png',27,52),size:{x:27,y:52},offset:{x:0,y:0},defaultOffset:{x:0,y:0},enemyType:'recycle',health:1,score_hit:50,score_killed:100,speedMin:25,speedMax:35,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('walk',0.2,[4,5,6,7]);this.addAnim('jump',0.2,[8,9,10,11],true);this.addAnim('hit',0.2,[12],true);this.addAnim('back_idle',0.2,[13,14,15,16]);this.addAnim('climb',0.2,[17,18,19,20]);},update:function(){this.parent();},kill:function(){this.spawnChunks(7,new ig.AnimationSheet('media/Recycle_Pieces_Sprite.png',14,17));this.parent();}});});

// lib/game/entities/enemy-cpu.js
ig.baked=true;ig.module('game.entities.enemy-cpu').requires('game.entities.enemy').defines(function(){EntityEnemyCpu=EntityEnemy.extend({animSheet:new ig.AnimationSheet('media/CPU_Sprite.png',52,54),size:{x:52,y:54},offset:{x:0,y:0},defaultOffset:{x:0,y:0},enemyType:'cpu',health:2,score_hit:100,score_killed:200,speedMin:25,speedMax:35,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('walk',0.2,[0,1,2,3]);this.addAnim('jump',0.2,[4,5,6,7],true);this.addAnim('hit',0.2,[8,9],true);this.addAnim('climb',0.2,[10,11,12,13]);},update:function(){this.parent();},kill:function(){this.spawnChunks(6,new ig.AnimationSheet('media/CPU_Pieces_Sprite.png',21,15));this.parent();}});});

// lib/game/entities/tank-cannon.js
ig.baked=true;ig.module('game.entities.tank-cannon').requires('game.entities.projectile').defines(function(){EntityTankCannon=EntityProjectile.extend({size:{x:33,y:14},offset:{x:0,y:9},maxVel:{x:100,y:100},checkAgainst:ig.Entity.TYPE.A,animSheet:new ig.AnimationSheet('media/Red_IE_Cannon_Bullet_Sprite.png',33,33),playerOffset:{x:-10,y:-15},damage:1,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',0.05,[0,1,2,3]);this.vel={x:this.maxVel.x*settings.direction.x*ig.game.difficultyManager.cycle,y:this.maxVel.y*settings.direction.y};ig.game.sounds.tank_cannon.play();},reset:function(x,y,settings){this.parent(x,y,settings);ig.game.sounds.tank_cannon.play();},update:function(){this.currentAnim=this.anims.idle;this.parent();}});});

// lib/game/entities/bullet-alt.js
ig.baked=true;ig.module('game.entities.bullet-alt').requires('game.entities.projectile').defines(function(){EntityBulletAlt=EntityProjectile.extend({_wmIgnore:true,size:{x:20,y:36},offset:{x:0,y:0},maxVel:{x:300,y:300},zIndex:110,fireOffset:{idle:{x:30,y:5,yDown:15},angle:{x:15,y:-10,yDown:15},vertical:{x:0,y:-20,yDown:30}},animSheet:new ig.AnimationSheet('media/weapons/bullet-alt.png',20,36),damage:3,init:function(x,y,settings){var offsets=this.offsetBullet(x,y,settings);if(settings.direction.x<0){x-=offsets.x;}else{x+=offsets.x;}
y+=offsets.y;this.parent(x,y,settings);this.addAnim('idle',1,[0]);this.addAnim('angled',1,[0]);this.addAnim('vertical',1,[0]);this.pointBullet(x,y,settings);},reset:function(x,y,settings){var offsets=this.offsetBullet(x,y,settings);if(settings.direction.x<0){x-=offsets.x;}else{x+=offsets.x;}
y+=offsets.y;this.parent(x,y,settings);this.pointBullet(x,y,settings);},check:function(other){other.receiveDamage(this.damage,this);},});});

// lib/game/entities/enemy-tank.js
ig.baked=true;ig.module('game.entities.enemy-tank').requires('game.entities.enemy','game.entities.tank-cannon','game.entities.bullet-alt').defines(function(){EntityEnemyTank=EntityEnemy.extend({spriteSheets:{tank_shield:new ig.AnimationSheet('media/Red_IE_Shield_Sprite.png',63,78),tank_cannon:new ig.AnimationSheet('media/Red_IE_Cannon_Sprite.png',63,78),},currentSheet:null,size:{x:50,y:78},offset:{x:0,y:0},defaultOffset:{x:0,y:0},enemyType:'tank',health:6,score_hit:200,score_killed:1000,speedMin:15,speedMax:25,gravityFactor:.3,direction:1,canfire:false,rate:2,shootTimer:null,cannonRange:25,jumping:false,shooting:false,init:function(x,y,settings){this.parent(x,y,settings);this.animSheet=this.spriteSheets['tank_shield'];this.addAnim('idle',1,[0],true);this.addAnim('walk',0.2,[1,2,3,4]);this.addAnim('jump',0.2,[6,7]);this.addAnim('hit',1,[8],true);this.addAnim('shoot',0.1,[13,14,15,16],true);this.addAnim('climb',0.2,[11,12]);this.shootTimer=new ig.Timer();},update:function(){if(this.currentAnim==this.anims.shoot&&this.currentAnim.loopCount<1){}
else if(this.jumping){this.currentAnim=this.anims.jump;this.vel.y=this.speed*-1;if(this.vel.x>=this.speed||this.vel.x<=-this.speed){this.jumping=false;}}
if(this.health<=this.baseHealth*0.5&&this.animSheet!=this.spriteSheets['tank_cannon']){this.shootTimer.set(.25);this.swapSheets(this.spriteSheets['tank_cannon']);}
this.direction=this.flip?-1:1;if(this.direction==-1){this.offset.x=15;}else{this.offset.x=this.defaultOffset.x;}
if(this.shootTimer.delta()>0&&this.standing&&this.pos.y+this.size.y>=ig.game.player.pos.y+ig.game.player.size.y-this.cannonRange&&this.pos.y+this.size.y<=ig.game.player.pos.y+ig.game.player.size.y+this.cannonRange&&this.health<=this.baseHealth*0.5&&ig.game.player.health>0){ig.game.spawnEntity(EntityTankCannon,this.pos.x+50*this.direction,this.pos.y+40,{direction:{x:this.direction,y:0}});this.shootTimer.set(this.rate);this.currentAnim=this.anims.shoot.rewind();this.shooting=true;}
this.parent();},handleMovementTrace:function(res){this.parent(res);if(res.collision.x&&!this.jumping){this.jumping=true;}},kill:function(){this.spawnChunks(13,new ig.AnimationSheet('media/Red_IE_Pieces_Sprite.png',32,31));this.parent();},climberJump:function(){this.climbing=false;this.canJump=false;this.jumping=true;},swapSheets:function(spriteSheet){this.animSheet=spriteSheet;_.each(this.anims,function(o){o.sheet=spriteSheet;},this);}});});

// lib/game/entities/choppa-door.js
ig.baked=true;ig.module('game.entities.choppa-door').requires('impact.entity').defines(function(){EntityChoppaDoor=ig.Entity.extend({size:{x:37,y:48},gravityFactor:0,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.PASSIVE,openDistance:25,zIndex:110,animSheet:new ig.AnimationSheet('media/Helo_Door.jpg',37,48),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);},update:function(){this.pos.x=ig.game.choppa.pos.x+ig.game.choppa.doorOffset.x;this.pos.y=ig.game.choppa.pos.y+ig.game.choppa.doorOffset.y;if(ig.game.choppa.callForPlayer&&this.openDistance>0){ig.game.choppa.doorOffset.x--;this.openDistance--;}
this.parent();},});});

// lib/game/entities/choppa-props.js
ig.baked=true;ig.module('game.entities.choppa-props').requires('impact.entity').defines(function(){EntityChoppaProps=ig.Entity.extend({size:{x:298,y:70},offset:{x:0,y:20},gravityFactor:0,zIndex:120,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/Helo_Props_Sprite.png',298,49),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',0.1,[0,1,2,3,]);},update:function(){this.pos.x=ig.game.choppa.pos.x+ig.game.choppa.propOffset.x;this.pos.y=ig.game.choppa.pos.y+ig.game.choppa.propOffset.y;this.parent();},});});

// lib/game/entities/choppa.js
ig.baked=true;ig.module('game.entities.choppa').requires('impact.entity','game.entities.choppa-door','game.entities.choppa-props').defines(function(){EntityChoppa=ig.Entity.extend({size:{x:172,y:88},offset:{x:105,y:44},maxVel:{x:200,y:100},friction:{x:2000,y:2000},gravityFactor:0,accelAir:500,speed:10,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/Helo_Body_Sprite.png',284,135),door:null,props:null,doorOffset:{x:64,y:11},propOffset:{x:-117,y:-40},getPlayer:false,zIndex:100,state:{flyAway:false},letterboxTimer:null,nextTriggered:false,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);ig.game.choppa=this;ig.game.sounds.choppa.play();},update:function(){if(!this.door)this.door=ig.game.spawnEntity(EntityChoppaDoor,this.pos.x+this.doorOffset.x,this.pos.y+this.doorOffset.y);if(!this.props)this.props=ig.game.spawnEntity(EntityChoppaProps,this.pos.x+this.propOffset.x,this.pos.y+this.propOffset.y);if(this.state.flyAway){if(!this.letterboxTimer)this.letterboxTimer=new ig.Timer(3);this.accel.x=this.accelAir;this.accel.y=-this.accelAir/5;if(!this.nextTriggered){if(this.letterboxTimer.delta()>0){this.nextTriggered=true;ig.game.endingSequence.next();}
else if(!this.checkOnScreen()){this.nextTriggered=true;setTimeout(function(){ig.game.endingSequence.next();},1000);}}}else if(ig.game.state.ending){ig.game.cameraTarget=this;if(this.pos.x<ig.game.player.pos.x-this.size.x*0.5+5){this.accel.x=this.accelAir;}else{this.accel.x=0;}
if(this.pos.y<ig.game.player.pos.y-this.size.y-100){this.accel.y=this.accelAir/5;}else{this.accel.y=0;}
if(this.pos.x>0&&this.accel.x==0&&this.accel.y==0&&!this.callForPlayer){ig.game.player.currentAnim=ig.game.player.anims.rescue;ig.game.player.vel.y=-500;this.callForPlayer=true;ig.game.player.dead=true;}}
this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;var res={collision:{x:false,y:false},pos:{x:this.pos.x+mx,y:this.pos.y+my},tile:{x:0,y:0}};this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}},kill:function(){this.door.kill();this.props.kill();this.parent();},checkOnScreen:function(){var px=this.pos.x,py=this.pos.y,hasSheet=(this.currentAnim)?true:false,padding=0;return(px>ig.game.screen.x-padding&&px<=ig.game.screen.x+ig.system.width)&&(py>ig.game.screen.y&&py<ig.game.screen.y+ig.system.height)?true:false;}});});

// lib/game/entities/xp-startup.js
ig.baked=true;ig.module('game.entities.xp-startup').requires('impact.entity').defines(function(){EntityXpStartup=ig.Entity.extend({size:{x:800,y:600},offset:{x:0,y:0},gravityFactor:0,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/xp_startup.jpg',800,600),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);},update:function(){this.parent();},});});

// lib/game/entities/welcome-screen.js
ig.baked=true;ig.module('game.entities.welcome-screen').requires('impact.entity').defines(function(){EntityWelcomeScreen=ig.Entity.extend({size:{x:800,y:600},offset:{x:0,y:0},gravityFactor:0,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/xp_welcome.jpg',800,600),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);},update:function(){this.parent();},});});

// lib/game/entities/desktop-standard.js
ig.baked=true;ig.module('game.entities.desktop-standard').requires('impact.entity').defines(function(){EntityDesktopStandard=ig.Entity.extend({size:{x:800,y:600},offset:{x:0,y:0},gravityFactor:0,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/xp_desktop_standard.jpg',800,600),init:function(x,y,settings){this.parent(x,y,settings);ig.game.sounds.xp_startup.play();this.addAnim('idle',1,[0],true);},update:function(){this.parent();},kill:function(){ig.game.sounds.xp_startup.stop();this.parent();}});});

// lib/game/entities/blue-screen.js
ig.baked=true;ig.module('game.entities.blue-screen').requires('impact.entity','plugins.impactEvents','game.entities.textplayer').defines(function(){EntityBlueScreen=ig.Entity.extend({size:{x:800,y:600},offset:{x:0,y:0},gravityFactor:0,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/blue_screen_standard.jpg',800,600),spriteSheets:{fadeIn:new ig.AnimationSheet('media/blue_screen_standard.jpg',800,600),fadeOut:new ig.AnimationSheet('media/blue_screen_out.jpg',800,600),},intro_text:null,showSkip:false,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);this.addAnim('to_blue',0.1,[1,2,3,4,5,6,7,8],true);this.addAnim('to_game',.3,[0,1,2,3,4,5,5],true);this.animSheet=this.spriteSheets['fadeIn'];this.anims.to_game.sheet=this.spriteSheets['fadeOut'];ig.game.sounds.xp_startup.stop();},update:function(){this.parent();if(!this.intro_text&&this.currentAnim==this.anims.to_blue&&this.currentAnim.frame>=7){this.showSkip=true;this.intro_text=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:15,drawY:15,textString:"                             Location // Windows XP 2014*\n\n\n\n\nIn the long, long ago, Windows XP rose like a phoenix\nfrom the ashes of Windows 2000.*\n\nAs newer operating systems came along, Windows XP clung to life,\na pestilence on the peaceful developer community.*\n\nWith their community thrown into turmoil,\nmost developers fled ages ago...one still remains.*\n\nOne man. One hero, still supporting IE6 on XP.*\n\nNow, He's fighting the final battle for his people -\nto destroy it once and for all.*\n\nIt's time for his escape. Here. Now.*\n\nTonight . . .",font:new ig.Font('media/fonts/console_white.png'),framerate:0.01,});textComplete=this.intro_text.addListener("complete",this.textCompleteHandler.bind(this));}
if(this.currentAnim==this.anims.to_game&&this.currentAnim.frame>=6){ig.game.introSequence.next();}},draw:function(){this.parent();if(this.showSkip)ig.game.font_console.draw("PRESS 'SPACE' TO SKIP",400,550,ig.Font.ALIGN.CENTER);},textCompleteHandler:function(){var scope=this;ig.game.sequenceTimeout=setTimeout(function(){scope.currentAnim=scope.anims.to_game.rewind();scope.intro_text.removeListener("complete",scope.textCompleteHandler.bind(scope));scope.intro_text.kill();scope.showSkip=false;},2000);},kill:function(){this.intro_text.kill();this.parent();}});});

// lib/game/entities/bg-animation.js
ig.baked=true;ig.module('game.entities.bg-animation').requires('impact.entity').defines(function(){EntityBgAnimation=ig.Entity.extend({size:{x:25,y:50},initLocation:{x:0,y:0},currLocation:{x:0,y:0},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,distance:1,animSheet:null,init:function(x,y,settings){if(settings.distance!=undefined){this.distance=settings.distance;}
this.parent(x,y,settings);this.initLocation.x=x;this.initLocation.y=y;this.currLocation.x=x;this.currLocation.y=y;},update:function(){if(this.currentAnim){this.currentAnim.update();}},draw:function(){if(!ig.global.wm){this.currLocation.x=this.currLocation.x+(this.vel.x/this.distance)*ig.system.tick;this.modLocation.x=this.currLocation.x-ig.game.screen.x/this.distance+ig.game.screen.x;this.modLocation.y=this.currLocation.y-ig.game.screen.y/this.distance+ig.game.screen.y;this.pos.x=this.modLocation.x;this.pos.y=this.modLocation.y;}
this.parent();}});});

// lib/game/entities/bg-boom.js
ig.baked=true;ig.module('game.entities.bg-boom').requires('game.entities.bg-animation').defines(function(){EntityBgBoom=EntityBgAnimation.extend({size:{x:800,y:600},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,distance:1,drawBeforeLayer:3,animSheet:new ig.AnimationSheet('media/bg_animations/Boom_City_Sprite_Transparent.png',800,600),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[15],true);this.addAnim('go_boom',.1,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],true);},update:function(){this.parent();},});});

// lib/game/entities/boom-flash.js
ig.baked=true;ig.module('game.entities.boom-flash').requires('impact.entity').defines(function(){EntityBoomFlash=ig.Entity.extend({size:{x:800,y:600},gravityFactor:0,animSheet:new ig.AnimationSheet('media/outro/Boom_Top_Sprite.png',800,600),alpha:0,speed:0.1,delay:null,zIndex:100,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[18],true);this.addAnim('flash',.08,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],true);},update:function(){this.parent();},draw:function(){if(this.currentAnim==this.anims.flash&&this.currentAnim.frame>=17){if(this.alpha<1){this.alpha+=this.speed;}
ig.system.context.fillStyle='rgba(255,255,255,'+this.alpha+')';ig.system.context.fillRect(0,0,800,600);}
this.parent();}});});

// lib/game/entities/letterbox.js
ig.baked=true;ig.module('game.entities.letterbox').requires('impact.entity','plugins.impactEvents').defines(function(){EntityLetterbox=ig.Entity.extend({_wmIgnore:true,size:{x:800,y:600},gravityFactor:0,zIndex:1500,borderDims:{top:90,right:90,bottom:160,left:90},border:0,center:0,canFadeIn:false,canFadeOut:false,fadeTime:0.02,scaleFactor:1,init:function(x,y,settings){this.parent(x,y,settings);},update:function(){this.pos.x=ig.game.screen.x;this.pos.y=ig.game.screen.y;if(!this.letterboxed&&this.border>=1){this.letterboxed=true;this.fire("letterboxed");}
if(this.canFadeOut&&this.center>=1){this.canFadeOut=false;this.fire("fadeOutComplete");}
if(this.canFadeIn&&this.center<=0){this.canFadeIn=false;this.fire("fadeInComplete");}
this.scaleFactor=1/ig.game.scaleValue;this.parent();},draw:function(){if(this.border<1)this.border+=this.fadeTime;if(this.canFadeIn&&this.center>0){if(this.center-this.fadeTime<0)this.center=0;else this.center-=this.fadeTime;}
else if(this.canFadeOut&&this.center<1){if(this.center+this.fadeTime>1)this.center=1;else this.center+=this.fadeTime;}
ig.system.context.fillStyle='rgba(0,0,0,1)';ig.system.context.fillRect(0,-90*this.scaleFactor+this.border*this.borderDims.top*this.scaleFactor,ig.system.width,90*this.scaleFactor);ig.system.context.fillRect(0,ig.system.height-this.border*this.borderDims.bottom*this.scaleFactor,ig.system.width,160*this.scaleFactor);ig.system.context.fillRect(-90*this.scaleFactor+this.border*this.borderDims.left*this.scaleFactor,0,90*this.scaleFactor,ig.system.height);ig.system.context.fillRect(ig.system.width-this.border*this.borderDims.right*this.scaleFactor,0,90*this.scaleFactor,ig.system.height);ig.system.context.fillStyle='rgba(0,0,0,'+this.center+')';ig.system.context.fillRect(90*this.scaleFactor,90*this.scaleFactor,620*this.scaleFactor,350*this.scaleFactor);this.parent();},fadeIn:function(){this.canFadeIn=true;},fadeOut:function(){this.canFadeOut=true;}});});

// lib/game/entities/earthquake.js
ig.baked=true;ig.module('game.entities.earthquake').requires('impact.entity','impact.timer').defines(function(){EntityEarthquake=ig.Entity.extend({_wmDrawBox:true,_wmBoxColor:'rgba(80, 130, 170, 0.7)',size:{x:8,y:8},duration:2,strength:8,quakeTimer:null,origX:null,origY:null,zero:false,isQuaking:false,moveX:false,moveY:true,init:function(x,y,settings){this.quakeTimer=new ig.Timer();this.parent(x,y,settings);},triggeredBy:function(entity,trigger){this.start(2,8);},start:function(dur,str){this.isQuaking=true;this.zero=false;if(this.moveX)this.origX=ig.game.screen.x;if(this.moveY)this.origY=ig.game.screen.y;this.duration=dur;this.strength=str;this.quakeTimer.set(this.duration);},update:function(){var delta=this.quakeTimer.delta();if(delta<-0.1){var s=this.strength*Math.pow(-delta/this.duration,2);if(s>0.5&&!this.zero){if(this.moveX)ig.game.screen.x+=(ig.game.random.range(0,100)/100).map(0,1,-s,s);if(this.moveY)ig.game.screen.y+=ig.game.random.range(-200,200)/100;this.zero=true;}else{this.resetScreen();}}else{if(this.isQuaking){this.resetScreen();this.isQuaking=false;}}
this.parent();},resetScreen:function(){ig.game.screen.y=this.origY;this.zero=false;}});});

// lib/game/entities/detonator-light.js
ig.baked=true;ig.module('game.entities.detonator-light').requires('impact.entity').defines(function(){EntityDetonatorLight=ig.Entity.extend({size:{x:50,y:22},gravityFactor:0,animSheet:new ig.AnimationSheet('media/outro/lightBlink_Sprite.png',50,22),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('off',1,[0],true);this.addAnim('on',1,[1],true);this.addAnim('blink',1,[0,1]);},update:function(){this.parent();},});});

// lib/game/entities/detonator-button.js
ig.baked=true;ig.module('game.entities.detonator-button').requires('impact.entity').defines(function(){EntityDetonatorButton=ig.Entity.extend({size:{x:67,y:48},gravityFactor:0,animSheet:new ig.AnimationSheet('media/outro/ButtonPush_Sprite.png',67,48),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);this.addAnim('push',1,[1],true);},update:function(){this.parent();},});});

// lib/game/entities/detonator-key.js
ig.baked=true;ig.module('game.entities.detonator-key').requires('impact.entity').defines(function(){EntityDetonatorKey=ig.Entity.extend({size:{x:62,y:61},gravityFactor:0,animSheet:new ig.AnimationSheet('media/outro/KeyTurn_Sprite.png',62,61),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);this.addAnim('turn',1,[1],true);},update:function(){this.parent();},});});

// lib/game/entities/outro-clippy.js
ig.baked=true;ig.module('game.entities.outro-clippy').requires('impact.entity').defines(function(){EntityOutroClippy=ig.Entity.extend({size:{x:194,y:283},maxVel:{x:500,y:500},friction:{x:2000,y:0},gravityFactor:0,bubbleTimer:null,animSheet:new ig.AnimationSheet('media/outro/Clippy_Detonator_Sprite.png',194,283),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);this.addAnim('blink',.1,[1,2,3,4,5,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);},update:function(){if(!this.bubbleTimer)this.bubbleTimer=new ig.Timer(.2);if(this.bubbleTimer&&this.bubbleTimer.delta()>0){this.currentAnim=this.anims.blink;this.bubbleTimer=null;}
this.parent();},});});

// lib/game/entities/outro-detonator.js
ig.baked=true;ig.module('game.entities.outro-detonator').requires('impact.entity','game.entities.detonator-light','game.entities.detonator-button','game.entities.detonator-key','game.entities.outro-clippy').defines(function(){EntityOutroDetonator=ig.Entity.extend({size:{x:620,y:349},gravityFactor:0,type:ig.Entity.TYPE.NONE,checkAgainst:ig.Entity.TYPE.NONE,collides:ig.Entity.COLLIDES.PASSIVE,animSheet:new ig.AnimationSheet('media/outro/Detonator_Background.jpg',620,349),light:null,button:null,key:null,clippy:null,clippyTimer:null,clippyDelay:10,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0],true);},update:function(){if(!this.light)this.light=ig.game.spawnEntity(EntityDetonatorLight,this.pos.x+132,this.pos.y+100);if(!this.button)this.button=ig.game.spawnEntity(EntityDetonatorButton,this.pos.x+258,this.pos.y+115);if(!this.key)this.key=ig.game.spawnEntity(EntityDetonatorKey,this.pos.x+182,this.pos.y+171);if(this.clippyTimer){if(!this.clippy&&this.clippyTimer.delta()>0){this.getClippy();}}
this.parent();},kill:function(){this.light.kill();this.button.kill();this.key.kill();if(this.clippy)this.clippy.kill();if(this.clippyTImer)this.clippyTimer.pause();this.parent();},getClippy:function(){this.clippy=ig.game.spawnEntity(EntityOutroClippy,ig.game.screen.x+500,ig.game.screen.y+116);}});});

// lib/game/entities/icon.js
ig.baked=true;ig.module('game.entities.icon').requires('impact.entity').defines(function(){EntityIcon=ig.Entity.extend({size:{x:32,y:28},gravityFactor:0,icon:null,shareURL:"None",animSheet:new ig.AnimationSheet('media/icons_share.png',32,28),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('twitter',1,[0],true);this.addAnim('facebook',1,[1],true);this.currentAnim=this.anims[this.icon];},update:function(){if(ig.input.pressed('mouse1')&&this.inFocus()){window.open(this.shareURL,'_blank');}
this.parent();},inFocus:function(){return((this.pos.x<=(ig.input.mouse.x+ig.game.screen.x))&&((ig.input.mouse.x+ig.game.screen.x)<=this.pos.x+this.size.x)&&(this.pos.y<=(ig.input.mouse.y+ig.game.screen.y))&&((ig.input.mouse.y+ig.game.screen.y)<=this.pos.y+this.size.y));}});});

// lib/game/entities/medal.js
ig.baked=true;ig.module('game.entities.medal').requires('impact.entity').defines(function(){EntityMedal=ig.Entity.extend({size:{x:216,y:192},gravityFactor:0,font:new ig.Font('media/fonts/FixedsysTTF_47_brown.png'),plaque:new ig.Image('media/outro/plaque.png'),plaque_hardcore:new ig.Image('media/outro/plaque_hardcore.png'),spriteSheets:{normal:new ig.AnimationSheet('media/outro/Medal_Sprite.png',216,192),hardcore:new ig.AnimationSheet('media/outro/Hardcore_Medal_Sprite.png',216,192),},shimmerTimer:null,shimmerDelay:6,init:function(x,y,settings){this.parent(x,y,settings);if(ig.game.servicePacks[0].active)this.animSheet=this.spriteSheets.hardcore;else this.animSheet=this.spriteSheets.normal;this.addAnim('idle',1,[0],true)
this.addAnim('shimmer',0.1,[1,2,3,4,5,6,7],true);this.shimmerTimer=new ig.Timer(this.shimmerDelay);},update:function(){if(this.shimmerTimer.delta()>0&&this.currentAnim==this.anims.idle){this.currentAnim=this.anims.shimmer.rewind();}
if(this.currentAnim==this.anims.shimmer&&this.currentAnim.frame>=6){this.currentAnim=this.anims.idle;this.shimmerTimer.set(this.shimmerDelay);}
this.parent();},draw:function(){this.parent();if(ig.game.servicePacks[0].active)this.plaque_hardcore.draw(386,160);else this.plaque.draw(386,160);this.font.draw(ig.game.numberWithCommas(ig.game.player.score),525,252,ig.Font.ALIGN.CENTER);}});});

// lib/game/entities/outro-credits.js
ig.baked=true;ig.module('game.entities.outro-credits').requires('impact.entity','game.entities.icon','game.entities.medal').defines(function(){EntityOutroCredits=ig.Entity.extend({gravityFactor:0,spriteSheets:{normal:new ig.AnimationSheet('media/outro/Normal_Background.jpg',800,600),hardcore:new ig.AnimationSheet('media/outro/Hardcore_Background.jpg',800,600),},font_sharing:new ig.Font('media/fonts/FixedsysTTF_28_grey.png'),modern_img:new ig.Image('media/credits/credits_modern.png'),bam_img:new ig.Image('media/credits/credits_bam.png'),musician_img:new ig.Image('media/credits/credits_nnnnnnnnnn.jpg'),title_img:new ig.Image('media/credits/credits_title.png'),ribbon:new ig.Image('media/outro/medal_ribbon.png'),medal:null,creditText:null,screens:["medal","modern","bam","musician","title","medal"],currentScreen:0,rollTimer:null,textDelay:null,textDelayValue:.6,frameLength:6.855,showReplay:false,musicStarted:false,init:function(x,y,settings){this.parent(x,y,settings);if(ig.game.servicePacks[0].active)this.animSheet=this.spriteSheets.hardcore;else this.animSheet=this.spriteSheets.normal;this.addAnim('idle',1,[0],true);ig.input.bind(ig.KEY.MOUSE1,'mouse1');ig.input.bind(ig.KEY.R,'restart');var shareHashtag=encodeURIComponent("#EscapefromXP");var shareLink=encodeURIComponent("http://bit.ly/escapefromxp");var redirectLink=encodeURIComponent("http://www.modern.ie/en-us/virtualization-tools#escape-from-ie");var shareImage=encodeURIComponent(window.location.origin+"/media/share/share_image.jpg");var shareMessage=encodeURIComponent("I just saved us all by destroying support for IE6 on XP forever. Try and beat my score of "+ig.game.numberWithCommas(ig.game.player.score)+"!");var shareTitle=encodeURIComponent("Escape from XP");var facebookAppId="1438536876391664";var facebookShareUrl="https://www.facebook.com/dialog/feed?app_id="+facebookAppId+"&display=popup&name="+shareTitle+"&caption="+shareMessage+"&link="+shareLink+"&redirect_uri="+redirectLink+"&description="+shareLink+"&picture="+shareImage;var twitterShareUrl="http://twitter.com/share?text="+shareMessage+"%20 "+shareHashtag+"&url="+shareLink;$("#share_facebook").attr("href",facebookShareUrl);$("#share_twitter").attr("href",twitterShareUrl);$(".share-link").show();},update:function(){if(!this.musicStarted){ig.music.play('credits');this.musicStarted=true;}
switch(this.screens[this.currentScreen]){case'medal':if(!this.medal)this.medal=ig.game.spawnEntity(EntityMedal,ig.game.screen.x+138,ig.game.screen.y+236);break;case'modern':this.showReplay=true;if(!this.creditText&&this.textDelay.delta()>0){this.creditText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:400,drawY:209,textString:"PRESENTED BY",font:ig.game.font_credits,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.03,enableSound:false});}
break;case'bam':if(!this.creditText&&this.textDelay.delta()>0){this.creditText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:400,drawY:145,textString:"DEVELOPED BY\nBRADLEY AND MONTGOMERY",font:ig.game.font_credits,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.03,enableSound:false});}
break;case'musician':if(!this.creditText&&this.textDelay.delta()>0){this.creditText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:400,drawY:145,textString:"WITH MUSIC BY\n\n\n\n\n\nNNNNNNNNNN.BANDCAMP.COM",font:ig.game.font_credits,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.03,enableSound:false});}
break;case'title':if(!this.creditText&&this.textDelay.delta()>0){this.creditText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:400,drawY:108,textString:"THANKS FOR PLAYING",font:ig.game.font_credits,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.03,enableSound:false});}
break;}
if(ig.input.pressed('restart')){$(".share-link").hide();ig.game.startGame();}
if(this.medal&&this.screens[this.currentScreen]!="medal"){this.medal.kill();this.medal=null;}
if(this.rollTimer&&this.rollTimer.delta()>=0){if(this.currentScreen+1<this.screens.length){this.nextFrame();this.rollTimer.set(this.frameLength);}else{this.rollTimer.pause();}}
this.parent();},draw:function(){this.parent();this.font_sharing.draw("SHARE:",317,32,ig.Font.ALIGN.LEFT);if(this.showReplay)ig.game.font_console.draw("PRESS 'R' TO REPLAY",400,580,ig.Font.ALIGN.CENTER);switch(this.screens[this.currentScreen]){case'medal':this.ribbon.draw(146,101);break;case'modern':this.modern_img.draw(218,243);break;case'bam':this.bam_img.draw(329,214);break;case'musician':this.musician_img.draw(140,212);break;case'title':this.title_img.draw(175,166);break;}},kill:function(){ig.input.unbind(ig.KEY.MOUSE1,'mouse1');ig.input.unbind(ig.KEY.R,'restart');this.parent();},nextFrame:function(){if(this.creditText){this.creditText.kill();this.creditText=null;}
if(!this.textDelay){this.textDelay=new ig.Timer(this.textDelayValue);}
else{if(this.currentScreen==3){this.textDelay.set(this.textDelayValue+2.5);}
else{this.textDelay.set(this.textDelayValue);}}
this.currentScreen++;}});});

// lib/game/entities/trigger.js
ig.baked=true;ig.module('game.entities.trigger').requires('impact.entity').defines(function(){EntityTrigger=ig.Entity.extend({size:{x:25,y:100},_wmScalable:true,_wmDrawBox:true,_wmBoxColor:'rgba(196, 255, 0, 0.7)',target:null,wait:-1,waitTimer:null,canFire:true,type:ig.Entity.TYPE.NONE,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,init:function(x,y,settings){if(settings.checks){this.checkAgainst=ig.Entity.TYPE[settings.checks.toUpperCase()]||ig.Entity.TYPE.A;delete settings.check;}
this.parent(x,y,settings);this.waitTimer=new ig.Timer();},check:function(other){if(this.canFire&&this.waitTimer.delta()>=0){if(typeof(this.target)=='object'){for(var t in this.target){var ent=ig.game.getEntityByName(this.target[t]);if(ent&&typeof(ent.triggeredBy)=='function'){ent.triggeredBy(other,this);}}}
if(this.wait==-1){this.canFire=false;}
else{this.waitTimer.set(this.wait);}}},update:function(){}});});

// lib/game/entities/startbar.js
ig.baked=true;ig.module('game.entities.startbar').requires('impact.entity').defines(function(){EntityStartbar=ig.Entity.extend({_wmIgnore:true,size:{x:800,y:30},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,player:null,bar:new ig.Image('media/hud/startbar.jpg'),init:function(x,y,settings){this.parent(x,y,settings);this.player=ig.game.player;this.zIndex=1000;},update:function(){this.pos.x=ig.game.screen.x;this.pos.y=ig.game.screen.y;ig.game.sortEntitiesDeferred();this.parent();},draw:function(){this.bar.draw(0,570);this.parent();}});});

// lib/game/entities/hud.js
ig.baked=true;ig.module('game.entities.hud').requires('impact.entity','game.entities.startbar').defines(function(){EntityHud=ig.Entity.extend({_wmIgnore:true,size:{x:800,y:600},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,lifeIndicatorPosition:{x:15,y:15},weaponIndicatorPosition:{x:625,y:0},weaponIndicatorPosition1:{x:623,y:7},weaponIndicatorPosition2:{x:680,y:10},scoreIndicatorPosition:{x:780,y:20},healthLabelIndicatorPosition:{x:92,y:50},startBar:null,player:null,lockedToCam:false,weaponIndicator1:new ig.Image('media/hud/weapon_indicator_machinegun_sprite.png'),weaponIndicator2:new ig.Image('media/hud/weapon_indicator_batteryblast_sprite.png'),lifebarPattern:new ig.Image('media/hud/lifebar_pattern.png'),lifebarFull:new ig.Image('media/hud/lifebar_full.png'),lifebarBorder:new ig.Image('media/hud/lifebar_border.png'),chargebarPattern:new ig.Image('media/hud/chargebar_pattern.png'),font:new ig.Font('media/fonts/04b03_30_white.png'),font_blue_small:new ig.Font('media/fonts/hud_22_blue.png'),font_red_small:new ig.Font('media/fonts/hud_22_red.png'),font_grey_large:new ig.Font('media/fonts/hud_40_grey.png'),init:function(x,y,settings){this.parent(x,y,settings);this.player=ig.game.player;this.startBar=ig.game.spawnEntity(EntityStartbar,0,0,{});},update:function(){this.parent();},drawHealth:function(){this.font_red_small.draw('HEALTH',this.pos.x-ig.game.screen.x+this.healthLabelIndicatorPosition.x,this.pos.y-ig.game.screen.y+this.healthLabelIndicatorPosition.y,ig.Font.ALIGN.RIGHT);var healthPct=this.player.health/this.player.maxHealth;var fullBarWidth=176;var adjustedBarWidth=Math.floor(healthPct*fullBarWidth);this.lifebarBorder.draw(this.pos.x-ig.game.screen.x+this.lifeIndicatorPosition.x,this.pos.y-ig.game.screen.y+this.lifeIndicatorPosition.y);if(healthPct>0)this.lifebarFull.drawTile(this.pos.x-ig.game.screen.x+this.lifeIndicatorPosition.x+5,this.pos.y-ig.game.screen.y+this.lifeIndicatorPosition.y+6,0,adjustedBarWidth,21);},drawWeaponIndicators:function(){this.font_red_small.draw(this.player.arsenal.active.name.toUpperCase(),this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition.x,50);var chargePct=1-(this.player.arsenal.weapons[1].shootTimer.delta()*-1)/this.player.arsenal.weapons[1].rate;switch(this.player.arsenal.active.name){case"Machine Gun":this.weaponIndicator1.drawTile(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition1.x,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition1.y,0,60,42);if(chargePct>=.95){this.weaponIndicator2.drawTile(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y,1,60,38);}else{this.weaponIndicator2.drawTile(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y,3,60,38);}
break;case"Battery Blast":this.weaponIndicator1.drawTile(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition1.x,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition1.y,1,60,42);if(chargePct>=.95){this.weaponIndicator2.drawTile(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y,0,60,38);}else{this.weaponIndicator2.drawTile(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y,2,60,38);}
break;default:break;}
if(this.player.arsenal.active.name=="Battery Blast"){ig.system.context.fillStyle="rgb(154,19,24)";}else{ig.system.context.fillStyle="rgb(53,12,14)";}
ig.system.context.beginPath();if(chargePct>=.25){ig.system.context.rect(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x+3,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y+25,5,6);ig.system.context.rect(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x+26,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y+25,5,6);}
if(chargePct>=.50){ig.system.context.rect(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x+3,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y+17,5,6);ig.system.context.rect(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x+26,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y+17,5,6);}
if(chargePct>=.75){ig.system.context.rect(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x+3,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y+9,5,6);ig.system.context.rect(this.pos.x-ig.game.screen.x+this.weaponIndicatorPosition2.x+26,this.pos.y-ig.game.screen.y+this.weaponIndicatorPosition2.y+9,5,6);}
ig.system.context.closePath();ig.system.context.fill();},drawScore:function(){this.font_blue_small.draw("SCORE",this.pos.x-ig.game.screen.x+400,16,ig.Font.ALIGN.CENTER);this.font_grey_large.draw(ig.game.numberWithCommas(this.player.score),this.pos.x-ig.game.screen.x+400,40,ig.Font.ALIGN.CENTER);},draw:function(){this.parent();if(this.lockedToCam){this.pos.x=ig.game.camera.pos.x;this.pos.y=ig.game.camera.pos.y;}else{this.pos.x=880;this.pos.y=0;}
this.drawHealth();this.drawWeaponIndicators();this.drawScore();},kill:function(){this.startBar.kill();this.parent();},lockToCam:function(){this.lockedToCam=true;}});});

// lib/game/entities/bg-title-smoke.js
ig.baked=true;ig.module('game.entities.bg-title-smoke').requires('game.entities.bg-animation').defines(function(){EntityBgTitleSmoke=EntityBgAnimation.extend({size:{x:428,y:474},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,animSheet:new ig.AnimationSheet('media/bg_animations/TitleScreenSmoke_Sprite.png',428,474),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',1,[0,1,2],false);},update:function(){this.parent();},});});

// lib/game/entities/bg-glow.js
ig.baked=true;ig.module('game.entities.bg-glow').requires('game.entities.bg-animation').defines(function(){EntityBgGlow=EntityBgAnimation.extend({size:{x:1967,y:828},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,flickerRate:2,flickerTimer:null,animSheet:new ig.AnimationSheet('media/bg_animations/OrangeGlow_Sprite2.png',1967,828),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('static',1,[0],true);if(settings.flickerRate)this.flickerRate=settings.flickerRate;if(settings.animated=="true"){if(!this.flickerTimer)this.flickerTimer=new ig.Timer(this.flickerRate)}},update:function(){if(this.flickerTimer){if(this.flickerTimer.delta()>0){this.currentAnim.alpha=ig.game.random.range(40,85)/100;this.flickerTimer.set(this.flickerRate);}}
this.parent();},});});

// lib/game/entities/bg-fire.js
ig.baked=true;ig.module('game.entities.bg-fire').requires('game.entities.bg-animation').defines(function(){EntityBgFire=EntityBgAnimation.extend({size:{x:25,y:25},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,flickerRate:.075,animSheet:new ig.AnimationSheet('media/bg_animations/Clippy_Fire_sprite.png',25,25),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('animated',this.flickerRate,[0,1,2,3],false);},update:function(){this.parent();},});});

// lib/game/entities/bg-smoke.js
ig.baked=true;ig.module('game.entities.bg-smoke').requires('game.entities.bg-animation').defines(function(){EntityBgSmoke=EntityBgAnimation.extend({size:{x:200,y:220},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,flickerRate:2,animSheet:new ig.AnimationSheet('media/bg_animations/BackgroundSmoke1_Sprite.png',200,220),init:function(x,y,settings){this.parent(x,y,settings);if(settings.flickerRate){this.flickerRate=settings.flickerRate;}
if(settings.animated=="true"){this.addAnim('animated',this.flickerRate,[0,1,2],false);}else{this.addAnim('static',1,[1],true);}},update:function(){this.parent();},});});

// lib/game/entities/bg-clippy.js
ig.baked=true;ig.module('game.entities.bg-clippy').requires('game.entities.bg-animation').defines(function(){EntityBgClippy=EntityBgAnimation.extend({size:{x:212,y:210},modLocation:{x:0,y:0},gravityFactor:0,maxVel:{x:300,y:500},speed:50,collides:ig.Entity.COLLIDES.NEVER,patrolRange:650,nextDirection:null,modPatrolRange:null,state:"walking",midShot:false,spriteSheets:{clippy:new ig.AnimationSheet('media/bg_animations/clippy_sprite.png',213,221),chewy:new ig.AnimationSheet('media/bg_animations/chewy_sprite.png',213,225)},init:function(x,y,settings){this.parent(x,y,settings);if(ig.game.servicePacks[1].active)this.animSheet=this.spriteSheets.chewy;else this.animSheet=this.spriteSheets.clippy;this.addAnim('walk',.25,[0,1,2,3,1,2,3,4,5,6],false);this.addAnim('laser',.1,[7,8,9,10,11,12,13,14,15,15,15,15,15,15],true)
this.vel.x=this.speed;this.modPatrolRange=this.patrolRange/settings.distance;},laserShot:function(nextDirection,midShot){this.state="laser";this.nextDirection=nextDirection;this.vel.x=0;this.currentAnim=this.anims.laser.rewind();if(midShot){if(nextDirection=="right"){this.currentAnim.flip.x=false;}else{this.currentAnim.flip.x=true;}}else{if(nextDirection=="right"){this.currentAnim.flip.x=true;}else{this.currentAnim.flip.x=false;}}},update:function(){this.parent();switch(this.state){case"walking":if(this.vel.x>0){if(this.currLocation.x<this.initLocation.x+this.modPatrolRange){if(this.currLocation.x>this.initLocation.x&&!this.midShot){this.laserShot("right",true);}}else{this.laserShot("left");}}else{if(this.currLocation.x>this.initLocation.x-this.modPatrolRange){if(this.currLocation.x<this.initLocation.x&&!this.midShot){this.laserShot("left",true);}}else{this.laserShot("right");}}
break;case"laser":if(this.currentAnim.frame==13){this.currentAnim=this.anims.walk;switch(this.nextDirection){case"left":this.vel.x=this.speed*-1;if(this.midShot){this.currLocation.x-=130;this.midShot=false;}else{this.midShot=true;}
this.currentAnim.flip.x=true;break;case"right":this.vel.x=this.speed;if(this.midShot){this.currLocation.x+=65;this.midShot=false;}else{this.midShot=true;}
this.currentAnim.flip.x=false;break;}
this.state="walking";}
break;}},});});

// lib/game/entities/bg-smoke2.js
ig.baked=true;ig.module('game.entities.bg-smoke2').requires('game.entities.bg-animation').defines(function(){EntityBgSmoke2=EntityBgAnimation.extend({size:{x:133,y:206},modLocation:{x:0,y:0},gravityFactor:0,collides:ig.Entity.COLLIDES.NEVER,animSheet:new ig.AnimationSheet('media/bg_animations/BackgroundSmoke2_Sprite.png',133,206),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('static',1,[0],true);if(settings.flip=="true"){this.currentAnim.flip.x=true;}},update:function(){this.parent();},});});

// lib/game/levels/level_1.js
ig.baked=true;ig.module('game.levels.level_1').requires('impact.image','game.entities.trigger','game.entities.bg-title-smoke','game.entities.bg-glow','game.entities.bg-fire','game.entities.bg-smoke','game.entities.bg-clippy','game.entities.bg-smoke2','game.entities.player').defines(function(){LevelLevel_1={"entities":[{"type":"EntityTrigger","x":1276,"y":272,"settings":{"name":"jump-trigger","target":{"1":"player"},"size":{"x":25,"y":4}}},{"type":"EntityBgTitleSmoke","x":-108,"y":8},{"type":"EntityTrigger","x":1000,"y":420,"settings":{"target":{"1":"player"},"name":"jump-trigger","size":{"x":25,"y":4}}},{"type":"EntityTrigger","x":1208,"y":320,"settings":{"target":{"1":"player"},"name":"jump-trigger","size":{"x":25,"y":4}}},{"type":"EntityTrigger","x":684,"y":424,"settings":{"target":{"1":"player"},"name":"shoot-left-trigger"}},{"type":"EntityBgGlow","x":560,"y":-172,"settings":{"name":"city_glow_1_1","animated":"true","drawBeforeLayer":3,"distance":1.1,"flickerRate":0.15}},{"type":"EntityTrigger","x":1392,"y":108,"settings":{"target":{"1":"player"},"name":"enemy-trigger","size":{"x":25,"y":116}}},{"type":"EntityBgGlow","x":1596,"y":-152,"settings":{"drawBeforeLayer":2,"animated":"true","name":"city_glow_2_2","flickerRate":0.15}},{"type":"EntityTrigger","x":1096,"y":368,"settings":{"name":"jump-trigger","target":{"1":"player"},"size":{"x":25,"y":4}}},{"type":"EntityTrigger","x":768,"y":424,"settings":{"name":"at-ease-trigger","target":{"1":"player"}}},{"type":"EntityBgFire","x":1552,"y":188,"settings":{"distance":1.1,"drawBeforeLayer":2}},{"type":"EntityBgGlow","x":348,"y":-132,"settings":{"drawBeforeLayer":2,"name":"city_glow_2_1"}},{"type":"EntityTrigger","x":608,"y":424,"settings":{"target":{"1":"player"},"name":"shoot-left-trigger"}},{"type":"EntityTrigger","x":952,"y":468,"settings":{"target":{"1":"player"},"name":"jump-trigger","size":{"x":25,"y":8}}},{"type":"EntityBgSmoke","x":872,"y":268,"settings":{"drawBehindLayer":4,"flickerRate":1,"drawBeforeLayer":5}},{"type":"EntityBgSmoke","x":2664,"y":220,"settings":{"drawBeforeLayer":5,"flickerRate":2}},{"type":"EntityBgSmoke","x":2068,"y":68,"settings":{"drawBeforeLayer":2,"distance":1.2}},{"type":"EntityBgSmoke","x":792,"y":108,"settings":{"drawBeforeLayer":2,"distance":1.2}},{"type":"EntityBgFire","x":864,"y":240,"settings":{"distance":1.2,"drawBeforeLayer":2}},{"type":"EntityBgFire","x":2176,"y":244,"settings":{"distance":1.2,"drawBeforeLayer":2}},{"type":"EntityBgFire","x":896,"y":340,"settings":{"distance":1.2,"drawBeforeLayer":2}},{"type":"EntityBgFire","x":1648,"y":180,"settings":{"distance":1.2,"drawBeforeLayer":2}},{"type":"EntityBgClippy","x":1428,"y":64,"settings":{"drawBeforeLayer":2,"distance":1.2}},{"type":"EntityBgSmoke2","x":1492,"y":84,"settings":{"distance":1.1,"drawBeforeLayer":1}},{"type":"EntityBgSmoke2","x":1580,"y":136,"settings":{"flip":"true","distance":1.2,"drawBeforeLayer":2}},{"type":"EntityPlayer","x":24,"y":412,"settings":{"name":"player"}}],"layer":[{"name":"background","width":6,"height":1,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/level_1_BG.jpg","repeat":false,"preRender":false,"distance":"2","tilesize":600,"foreground":false,"data":[[1,2,3,4,5,6]]},{"name":"terrain_back_city_3","width":6,"height":1,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/level_1_city_3.png","repeat":false,"preRender":false,"distance":"1.3","tilesize":600,"foreground":false,"data":[[1,2,3,4,5,0]]},{"name":"terrain_back_city_2","width":6,"height":1,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/level_1_city_2.png","repeat":false,"preRender":false,"distance":"1.2","tilesize":600,"foreground":false,"data":[[1,2,3,5,5,6]]},{"name":"terrain_back_city_1","width":6,"height":1,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/level_1_city_1.png","repeat":false,"preRender":false,"distance":"1.1","tilesize":600,"foreground":false,"data":[[1,2,3,4,5,6]]},{"name":"terrain_back_1","width":6,"height":1,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/level_1_back_hill.png","repeat":false,"preRender":false,"distance":"1.05","tilesize":600,"foreground":false,"data":[[1,2,3,4,5,6]]},{"name":"terrain","width":6,"height":1,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/level_1_front.png","repeat":false,"preRender":false,"distance":"1","tilesize":600,"foreground":false,"data":[[1,2,3,4,5,6]]},{"name":"terrain_title","width":24,"height":6,"linkWithCollision":false,"visible":1,"tilesetName":"media/level_1/terrain_title.png","repeat":false,"preRender":false,"distance":".8","tilesize":100,"foreground":false,"data":[[0,1,2,3,4,5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,13,14,15,16,17,18,19,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,25,26,27,28,29,30,31,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,39,40,41,42,43,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{"name":"collision","width":144,"height":24,"linkWithCollision":false,"visible":1,"tilesetName":"","repeat":false,"preRender":false,"distance":1,"tilesize":25,"foreground":false,"data":[[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,5,6,7,1,1,1,1,1,27,28,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]};LevelLevel_1Resources=[new ig.Image('media/level_1/level_1_BG.jpg'),new ig.Image('media/level_1/level_1_city_3.png'),new ig.Image('media/level_1/level_1_city_2.png'),new ig.Image('media/level_1/level_1_city_1.png'),new ig.Image('media/level_1/level_1_back_hill.png'),new ig.Image('media/level_1/level_1_front.png'),new ig.Image('media/level_1/terrain_title.png')];});

// lib/game/levels/intro.js
ig.baked=true;ig.module('game.levels.intro').requires('impact.image').defines(function(){LevelIntro={"entities":[],"layer":[]};});

// lib/game/levels/outro.js
ig.baked=true;ig.module('game.levels.outro').requires('impact.image').defines(function(){LevelOutro={"entities":[],"layer":[]};});

// lib/game/classes/random.js
ig.baked=true;ig.module('game.classes.random').defines(function(){Random=ig.Class.extend({instance:null,mt:null,staticInstantiate:function(){if(Random.instance==null){return null;}else{return Random.instance;}},init:function(){Random.instance=this;this.mt=new MersenneTwister();},range:function(min,max){return Math.floor(this.mt.random()*(max-min+1))+min;}});});var MersenneTwister=function(seed){if(seed==undefined){seed=new Date().getTime();}
this.N=624;this.M=397;this.MATRIX_A=0x9908b0df;this.UPPER_MASK=0x80000000;this.LOWER_MASK=0x7fffffff;this.mt=new Array(this.N);this.mti=this.N+1;this.init_genrand(seed);}
MersenneTwister.prototype.init_genrand=function(s){this.mt[0]=s>>>0;for(this.mti=1;this.mti<this.N;this.mti++){var s=this.mt[this.mti-1]^(this.mt[this.mti-1]>>>30);this.mt[this.mti]=(((((s&0xffff0000)>>>16)*1812433253)<<16)+(s&0x0000ffff)*1812433253)
+this.mti;this.mt[this.mti]>>>=0;}}
MersenneTwister.prototype.init_by_array=function(init_key,key_length){var i,j,k;this.init_genrand(19650218);i=1;j=0;k=(this.N>key_length?this.N:key_length);for(;k;k--){var s=this.mt[i-1]^(this.mt[i-1]>>>30)
this.mt[i]=(this.mt[i]^(((((s&0xffff0000)>>>16)*1664525)<<16)+((s&0x0000ffff)*1664525)))
+init_key[j]+j;this.mt[i]>>>=0;i++;j++;if(i>=this.N){this.mt[0]=this.mt[this.N-1];i=1;}
if(j>=key_length)j=0;}
for(k=this.N-1;k;k--){var s=this.mt[i-1]^(this.mt[i-1]>>>30);this.mt[i]=(this.mt[i]^(((((s&0xffff0000)>>>16)*1566083941)<<16)+(s&0x0000ffff)*1566083941))
-i;this.mt[i]>>>=0;i++;if(i>=this.N){this.mt[0]=this.mt[this.N-1];i=1;}}
this.mt[0]=0x80000000;}
MersenneTwister.prototype.genrand_int32=function(){var y;var mag01=new Array(0x0,this.MATRIX_A);if(this.mti>=this.N){var kk;if(this.mti==this.N+1)
this.init_genrand(5489);for(kk=0;kk<this.N-this.M;kk++){y=(this.mt[kk]&this.UPPER_MASK)|(this.mt[kk+1]&this.LOWER_MASK);this.mt[kk]=this.mt[kk+this.M]^(y>>>1)^mag01[y&0x1];}
for(;kk<this.N-1;kk++){y=(this.mt[kk]&this.UPPER_MASK)|(this.mt[kk+1]&this.LOWER_MASK);this.mt[kk]=this.mt[kk+(this.M-this.N)]^(y>>>1)^mag01[y&0x1];}
y=(this.mt[this.N-1]&this.UPPER_MASK)|(this.mt[0]&this.LOWER_MASK);this.mt[this.N-1]=this.mt[this.M-1]^(y>>>1)^mag01[y&0x1];this.mti=0;}
y=this.mt[this.mti++];y^=(y>>>11);y^=(y<<7)&0x9d2c5680;y^=(y<<15)&0xefc60000;y^=(y>>>18);return y>>>0;}
MersenneTwister.prototype.genrand_int31=function(){return(this.genrand_int32()>>>1);}
MersenneTwister.prototype.genrand_real1=function(){return this.genrand_int32()*(1.0/4294967295.0);}
MersenneTwister.prototype.random=function(){return this.genrand_int32()*(1.0/4294967296.0);}
MersenneTwister.prototype.genrand_real3=function(){return(this.genrand_int32()+0.5)*(1.0/4294967296.0);}
MersenneTwister.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return(a*67108864.0+b)*(1.0/9007199254740992.0);}

// lib/game/classes/enemy-factory.js
ig.baked=true;ig.module('game.classes.enemy-factory').requires('impact.game','impact.timer','game.entities.enemy','game.classes.random').defines(function(){EnemyFactory=ig.Class.extend({enemyTimer:new ig.Timer(),enemyLoop:5,enemiesPerLoop:{min:15,max:25},maxEnemies:500,initEnemies:40,availableEnemyTypes:['EntityEnemyRecycleBin','EntityEnemyRecycleBin','EntityEnemyRecycleBin','EntityEnemyRecycleBin','EntityEnemyRecycleBin','EntityEnemyRecycleBin','EntityEnemyCpu','EntityEnemyCpu','EntityEnemyCpu','EntityEnemyCpu','EntityEnemyCpu','EntityEnemyCpu','EntityEnemyTank'],isPaused:false,init:function(){if(ig.game.servicePacks[2].active){this.availableEnemyTypes=['EntityEnemyTank'];}
this.generateEnemies(this.initEnemies);this.enemyTimer.set(this.enemyLoop);},check:function(){if(!this.isPaused&&this.enemyTimer.delta()>=0){var total=ig.game.random.range(this.enemiesPerLoop.min,this.enemiesPerLoop.max);this.generateEnemies(total);this.enemyTimer.set(this.enemyLoop);}},generateEnemies:function(cnt){if((ig.game.getAllEnemies().length+cnt)>this.maxEnemies){cnt=this.maxEnemies-ig.game.getAllEnemies().length;}
for(var i=cnt-1;i>=0;i--){var e,hasSheet=false,climbing=ig.game.random.range(0,1)==1?true:false,pos=this.generatePosition(climbing),type=ig.game.random.range(0,(this.availableEnemyTypes.length-1));e=ig.game.spawnEntity(this.availableEnemyTypes[type],pos.x,pos.y,{direction:pos.dir,climbing:climbing});e.speedMin=Math.floor((ig.game.difficultyManager.cycle-1)*40+e.speedMin);e.speedMax=Math.floor((ig.game.difficultyManager.cycle-1)*40+e.speedMax);e.speed=Math.floor(ig.game.random.range(e.speedMin,e.speedMax));e.health=Math.floor(ig.game.difficultyManager.cycle*e.health);e.baseHealth=e.health;hasSheet=(e.animSheet)?true:false;}},generatePosition:function(climbing){var pos={},direction=null,highBound=0,lowBound=0,blockWidth=ig.game.collisionMap.width*ig.game.collisionMap.tilesize;if(climbing){if(!ig.game.player.dead){lowBound=ig.game.screen.x;highBound=ig.game.screen.x+ig.system.width;}else{lowBound=850;highBound=3100;}
pos.y=ig.system.height+ig.game.random.range(0,50*ig.game.difficultyManager.cycle);}else{direction=ig.game.random.range(0,1);if(direction===0){highBound=ig.game.screen.x-100;lowBound=ig.game.screen.x-400;}else{lowBound=ig.game.screen.x+ig.system.width;highBound=ig.game.screen.x+ig.system.width+400;}
pos.y=-200;}
pos.x=ig.game.random.range(lowBound,highBound);pos.dir=direction;return pos;},pause:function(){this.isPaused=true;},restart:function(){this.isPaused=false;}});});

// lib/game/classes/difficulty-manager.js
ig.baked=true;ig.module('game.classes.difficulty-manager').requires('impact.game','impact.timer').defines(function(){DifficultyManager=ig.Class.extend({cycle:1,modifierTimer:new ig.Timer(),modifierLoop:60,isPaused:false,init:function(){this.modifierTimer.set(this.modifierLoop);},check:function(){if(this.modifierTimer.delta()>0){this.cycle++;this.modifierTimer.set(this.modifierLoop);}},pause:function(){this.isPaused=true;},restart:function(){this.isPaused=false;}});});

// lib/game/classes/sounds.js
ig.baked=true;ig.module('game.classes.sounds').requires('impact.game','impact.sound').defines(function(){Sounds=ig.Class.extend({music_level:new ig.Sound("media/music/lesfleurs.mp3",false),music_credits:new ig.Sound("media/music/credits.mp3",false),player_hit:new ig.Sound("media/sounds/player_hit_dmg.mp3",false),machine_gun:new ig.Sound("media/sounds/machine_gun.mp3",false),battery_blast:new ig.Sound("media/sounds/battery_blast_2.mp3",false),battery_charge:new ig.Sound("media/sounds/battery_charge.mp3",false),enemy_death_1:new ig.Sound("media/sounds/enemy_death_combined.mp3"),enemy_death_2:new ig.Sound("media/sounds/enemy_death_combined_2.mp3"),tank_cannon:new ig.Sound("media/sounds/tank_cannon_dmg_echo.mp3"),xp_startup:new ig.Sound("media/sounds/windows-xp-startup.mp3",false),xp_error:new ig.Sound("media/sounds/xp_error.mp3",false),choppa:new ig.Sound("media/sounds/chopper_dmg.mp3",false),typing:new ig.Sound("media/sounds/typing_2.mp3",false),glitch:new ig.Sound("media/sounds/glitch.mp3",false),explosion:new ig.Sound("media/sounds/explosion_mixdown.mp3",false),survive:new ig.Sound("media/sounds/survive.mp3",false),init:function(){ig.music.add(this.music_level,'level_1');ig.music.add(this.music_credits,'credits');ig.music.volume=0.2;ig.music.loop=true;ig.music.stop;this.setInitialVolume();},setInitialVolume:function(){this.player_hit.volume=0.4;this.machine_gun.volume=0.3;this.battery_blast.volume=0.5;this.battery_charge.volume=0.4;this.enemy_death_1.volume=0.3;this.enemy_death_2.volume=0.3;this.tank_cannon.volume=.4;this.xp_startup.volume=.5;this.xp_error.volume=.5;this.choppa.volume=.6;this.typing.volume=.2;this.glitch.volume=.3;this.explosion.volume=0.8;this.survive.volume=0.9;}});});

// lib/plugins/camera.js
ig.baked=true;ig.module('plugins.camera').defines(function(){"use strict";ig.Camera=ig.Class.extend({trap:{pos:{x:0,y:0},size:{x:16,y:16}},min:{x:0,y:0},max:{x:0,y:0},offset:{x:0,y:0},pos:{x:0,y:0},damping:5,lookAhead:{x:0,y:0},currentLookAhead:{x:0,y:0},debug:false,init:function(offsetX,offsetY,damping){this.offset.x=offsetX;this.offset.y=offsetY;this.damping=damping;},set:function(entity){this.trap.pos.x=entity.pos.x-this.trap.size.x/2;this.trap.pos.y=entity.pos.y+entity.size.y-this.trap.size.y;this.pos.x=this.trap.pos.x-this.offset.x;this.pos.y=this.trap.pos.y-this.offset.y;this.currentLookAhead.x=0;this.currentLookAhead.y=0;},follow:function(entity){this.pos.x=this.move('x',entity.pos.x,entity.size.x);this.pos.y=this.move('y',entity.pos.y,entity.size.y);ig.game.screen.x=this.pos.x;ig.game.screen.y=this.pos.y;},move:function(axis,pos,size){var lookAhead=0;if(pos<this.trap.pos[axis]){this.trap.pos[axis]=pos;this.currentLookAhead[axis]=this.lookAhead[axis];}
else if(pos+size>this.trap.pos[axis]+this.trap.size[axis]){this.trap.pos[axis]=pos+size-this.trap.size[axis];this.currentLookAhead[axis]=-this.lookAhead[axis];}
return(this.pos[axis]-(this.pos[axis]-this.trap.pos[axis]+this.offset[axis]
+this.currentLookAhead[axis])*ig.system.tick*this.damping).limit(this.min[axis],this.max[axis]);},draw:function(){if(this.debug){ig.system.context.fillStyle='rgba(255,0,255,0.3)';ig.system.context.fillRect((this.trap.pos.x-this.pos.x)*ig.system.scale,(this.trap.pos.y-this.pos.y)*ig.system.scale,this.trap.size.x*ig.system.scale,this.trap.size.y*ig.system.scale);}}});});

// lib/plugins/sequencer.js
ig.baked=true;ig.module('plugins.sequencer').requires('impact.impact').defines(function(){ig.Sequencer=ig.Class.extend({list:[],index:-1,finished:false,init:function(){},add:function(sequencedFunction){this.list.push(sequencedFunction);},start:function(){this.index=-1;this.next();if(typeof(this.onStart)=="function"){this.onStart()};},end:function(){if(typeof(this.onEnd)=="function"){this.onEnd()};this.finished=true;},next:function(){this.index++;if(this.index==this.list.length){return this.end()};var nextFunction=this.list[this.index];if(nextFunction){nextFunction(this)};}});});

// lib/plugins/xp-loader.js
ig.baked=true;ig.module('plugins.xp-loader').requires('impact.loader').defines(function(){ig.XpLoader=ig.Loader.extend({endTime:0,gameDelayTime:0,minLoaderTime:3000,startTime:Date.now(),logoWidth:800,logoHeight:600,img:new ig.Image('media/xp_loading.jpg'),loadBar:new ig.Image('media/loadbar.png'),loadBarOverlay:new ig.Image('media/loadbar_outline.png'),ticker:0,loadbarFrames:[293,303,313,323,333,343,353,363,373,383,393,403,413,423,433,443,453,463],frame:0,framerate:7,end:function(){this.parent();this.endTime=Date.now();ig.system.setDelegate(this);},run:function(){if(Date.now()-this.startTime>this.minLoaderTime){ig.system.setDelegate(ig.game);return;}
var t=Date.now()-this.endTime;var alpha=1;this.draw();},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;this.img.draw(0,0);var ctx=ig.system.context;ctx.fillStyle='rgb(40,40,40)';ctx.fillRect(320,440,156*this._drawStatus,18);this.loadBar.draw(this.loadbarFrames[this.frame],441);this.loadBarOverlay.draw(235,433);if(this.ticker>this.frame*this.framerate){this.frame=this.frame==this.loadbarFrames.length-1?0:this.frame+1;}
if(this.ticker>(this.loadbarFrames.length-1)*this.framerate)this.ticker=-this.framerate;else this.ticker++;},drawPaths:function(color,paths){var ctx=ig.system.context;ctx.fillStyle=color;for(var i=0;i<paths.length;i+=2){ctx[ig.B2DSplashLoader.OPS[paths[i]]].apply(ctx,paths[i+1]);}}});});

// lib/game/main.js
ig.baked=true;ig.module('game.main').requires('impact.game','impact.font','game.entities.player','game.entities.enemy-recycle-bin','game.entities.enemy-cpu','game.entities.enemy-tank','game.entities.choppa','game.entities.xp-startup','game.entities.welcome-screen','game.entities.desktop-standard','game.entities.blue-screen','game.entities.bg-boom','game.entities.boom-flash','game.entities.letterbox','game.entities.earthquake','game.entities.outro-detonator','game.entities.outro-credits','game.entities.trigger','game.entities.hud','game.levels.level_1','game.levels.intro','game.levels.outro','game.classes.enemy-factory','game.classes.difficulty-manager','game.classes.random','game.classes.sounds','plugins.camera','plugins.impactEvents','plugins.sequencer','plugins.xp-loader').defines(function(){MyGame=ig.Game.extend({gravity:1200,paused:true,sounds:null,enemyFactory:null,difficultyManager:null,xpStartup:null,welcomeScreen:null,xpDesktop:null,blueScreen:null,hud:null,introSequence:null,sequenceTimeout:null,endingSequence:null,chopperView:null,choppa:null,letterbox:null,earthquake:null,detonator:null,credits:null,achievementText:null,outroText:null,boom:null,boomFlash:null,scaleValue:1,state:{intro:true,level:false,ending:false,},controlEnabled:false,cameraTarget:null,font_console:new ig.Font('media/fonts/console_white.png'),font_credits:new ig.Font('media/fonts/FixedsysTTF_28_white.png'),font_zoom1:new ig.Font('media/fonts/zoom_1.png'),font_zoom2:new ig.Font('media/fonts/zoom_2.png'),random:new Random(),servicePacks:[{id:'hardcoreMode',active:false,mode:"Hardcore Mode",system:"You must be the one. Your path will be difficult. The reward will be great.",message:"HARDCORE MODE: x4 SCORE MULTIPLIER. 1HP.",achievment:"HARDCORE"},{id:'originalHacker',active:false,mode:"Original Hacker Mode",system:"I'm surprised all the digits fit.",message:"",achievement:null},{id:'tanksTanksTanks',active:false,mode:"Certain Death Mode",system:"You asked for it.",message:"",achievement:null},{id:'IDDQD',active:false,mode:"God Mode",system:"There is no end. High chance of system crash.",message:"",achievement:null}],init:function(){ig.input.bind(ig.KEY.MOUSE1,'mouse1');ig.input.bind(ig.KEY.A,'left');ig.input.bind(ig.KEY.D,'right');ig.input.bind(ig.KEY.W,'jump');ig.input.bind(ig.KEY.SPACE,'jump');ig.input.bind(ig.KEY.LEFT_ARROW,'shoot_left');ig.input.bind(ig.KEY.RIGHT_ARROW,'shoot_right');ig.input.bind(ig.KEY.UP_ARROW,'shoot_up');ig.input.bind(ig.KEY.DOWN_ARROW,'shoot_down');this.sounds=new Sounds();this.introSequence=new ig.Sequencer();this.introSequence.add(this.getXpStartup.bind(this));this.introSequence.add(this.getWelcomeScreen.bind(this));this.introSequence.add(this.launchDesktop.bind(this));this.introSequence.add(this.getBlueScreen.bind(this));this.introSequence.add(this.blueScreenOut.bind(this));this.introSequence.add(this.introTextOut.bind(this));this.introSequence.start();this.endingSequence=new ig.Sequencer();this.endingSequence.add(this.getToTheChoppa.bind(this));this.endingSequence.add(this.getLetterbox.bind(this));this.endingSequence.add(this.outroFade_1.bind(this));this.endingSequence.add(this.zoom1In.bind(this));this.endingSequence.add(this.zoom2In.bind(this));this.endingSequence.add(this.getOutroDetonator.bind(this));this.endingSequence.add(this.getOutroText.bind(this));this.endingSequence.add(this.getOutroText2.bind(this));this.endingSequence.add(this.getNuke.bind(this));this.endingSequence.add(this.getOutroMedal.bind(this));this.endingSequence.add(this.getFinalText.bind(this));},loadLevel:function(data){this.currentLevel=data;this.parent(data);ig.game.screen.x=70;switch(data){case LevelLevel_1:this.setupCamera(this.player);return;}},setupCamera:function(entity){this.camera=new ig.Camera(ig.system.width/3,ig.system.height/3,2);this.camera.trap.size.x=ig.system.width/5;this.camera.trap.size.y=ig.system.height/5;this.camera.lookAhead.x=0;this.camera.min.x=70;this.camera.max.x=this.collisionMap.pxWidth-ig.system.width;this.camera.max.y=this.collisionMap.pxHeight-ig.system.height;this.camera.set(entity);this.cameraTarget=entity;},update:function(){this.parent();if(this.cameraTarget)this.camera.follow(this.cameraTarget);if(this.state.intro){this.introHandler();}else if(this.state.ending){this.outroHandler();}else{if(!this.paused){this.difficultyManager.check();this.enemyFactory.check();}}},draw:function(){if(this.state.intro){this.parent();}else if(this.state.ending){if(this.scaleValue!=1){ig.system.context.save();ig.system.context.scale(this.scaleValue,this.scaleValue);this.parent();ig.system.context.restore();}else{this.parent();}}else{this.parent();}},getAllEnemies:function(){return this.getEntitiesByType(EntityEnemy);},startGame:function(){clearTimeout(this.sequenceTimeout);ig.input.unbind(ig.KEY.MOUSE1,'mouse1');for(var i=0;i<ig.game.entities.length;i++){ig.game.entities[i].kill();}
ig.game.sounds.setInitialVolume();this.loadLevel(LevelLevel_1);this.hud=this.spawnEntity(EntityHud,0,0,{});this.state.intro=false;this.state.level=true;this.state.ending=false;this.paused=true;if(this.difficultyManager){this.difficultyManager.cycle=1;this.difficultyManager.paused=false;}
if(this.enemyFactory)this.enemyFactory.paused=false;ga("send","event","game","play");if(this.servicePacks[0].active)ga("send","event","game","hardcore");if(this.servicePacks[1].active)ga("send","event","game","hacker");if(this.servicePacks[2].active)ga("send","event","game","tanks");if(this.servicePacks[3].active)ga("send","event","game","godmode");},startWaves:function(){this.difficultyManager=new DifficultyManager();this.enemyFactory=new EnemyFactory();this.paused=false;},introHandler:function(){if(this.xpDesktop&&ig.input.pressed('mouse1')){clearTimeout(this.sequenceTimeout);ig.input.unbind(ig.KEY.MOUSE1,'mouse1');this.introSequence.next();}
else if(ig.input.pressed('jump')){clearTimeout(this.sequenceTimeout);this.startGame();}
this.messageHandler();},outroHandler:function(){if(this.chopperView){ig.game.screen.x-=0.5;}
if(this.canBlow&&ig.input.pressed('jump')||ig.input.pressed('mouse1')){ig.input.unbind(ig.KEY.MOUSE1,'mouse1');this.canBlow=false;this.endingSequence.next();}},messageHandler:function(){if(this.servicePacks[0].active==false&&window.hardcoreMode==true){this.servicePacks[0].active=true;console.log("You must be The One. Your path will be hard. The reward will be great.");}
if(this.servicePacks[1].active==false&&window.originalHacker==true){this.servicePacks[1].active=true;console.log("I'm surprised all the digits fit.");}},getXpStartup:function(currentSequence){this.xpStartup=ig.game.spawnEntity(EntityXpStartup,ig.game.screen.x,0);this.sequenceTimeout=setTimeout(function(){currentSequence.next();},4000);},getWelcomeScreen:function(currentSequence){this.xpStartup.kill();this.welcomScreen=ig.game.spawnEntity(EntityWelcomeScreen,ig.game.screen.x,0);this.sequenceTimeout=setTimeout(function(){currentSequence.next();},1500);},launchDesktop:function(currentSequence){this.welcomScreen.kill();this.xpDesktop=ig.game.spawnEntity(EntityDesktopStandard,ig.game.screen.x,0);this.sequenceTimeout=setTimeout(function(){currentSequence.next();},5000);},getBlueScreen:function(currentSequence){this.xpDesktop.kill();this.blueScreen=ig.game.spawnEntity(EntityBlueScreen,ig.game.screen.x,0);ig.input.unbind(ig.KEY.MOUSE1,'mouse1');var scope=this;this.sequenceTimeout=setTimeout(function(){currentSequence.next();},1000);},blueScreenOut:function(currentSequence){this.blueScreen.currentAnim=this.blueScreen.anims.to_blue.rewind();this.sounds.glitch.play();},introTextOut:function(currentSequence){clearTimeout(this.sequenceTimeout);this.blueScreen.kill();this.startGame();},getToTheChoppa:function(currentSequence){this.difficultyManager.paused=true;this.choppa=ig.game.spawnEntity(EntityChoppa,-150,-100);var scope=this;sequenceTimeout=setTimeout(function(){scope.state.level=false;scope.state.ending=true;ig.game.camera.min.x=0;ig.game.camera.min.y=-600;ig.game.camera.damping=1;},1500);},getLetterbox:function(currentSequence){this.cameraTarget=null;this.letterbox=ig.game.spawnEntity(EntityLetterbox,ig.game.screen.x,ig.game.screen.y);this.letterbox.addListener("letterboxed",function(){ig.game.choppa.kill();ig.game.removeEntity(ig.game.player);currentSequence.next();});},fadeOutHander:function(){var scope=this;if(this.earthquake)ig.game.earthquake.reset();this.sequenceTimeout=setTimeout(function(){scope.endingSequence.next();},1000);},fadeInHandler:function(){var scope=this;this.sequenceTimeout=setTimeout(function(){scope.letterbox.fadeOut();},2000);},completeHander:function(){this.endingSequence.next();},outroFade_1:function(currentSequence){this.hud.kill();this.letterbox.fadeOut();this.letterbox.addListener("fadeOutComplete",this.fadeOutHander.bind(this));},zoom1In:function(currentSequence){ig.game.sounds.choppa.play();ig.game.screen.y=0;ig.game.screen.x=1600;this.scaleValue=0.8;ig.system.width=ig.system.realWidth/this.scaleValue;ig.system.height=ig.system.realHeight/this.scaleValue;this.chopperView=true;this.earthquake=this.spawnEntity(EntityEarthquake,300,300,{name:'quake'});ig.game.earthquake.start(7,2);this.letterbox.fadeIn();this.letterbox.addListener("fadeInComplete",this.fadeInHandler.bind(this));this.achievementText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:500,drawY:650,textString:"ACHIEVEMENT UNLOCKED: LAST MAN OUT",font:this.font_zoom1,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.03,duration:3.5});},zoom2In:function(currentSequence){this.scaleValue=0.4;ig.game.screen.y=-600;ig.game.screen.x=1000;ig.system.width=ig.system.realWidth/this.scaleValue;ig.system.height=ig.system.realHeight/this.scaleValue;ig.game.earthquake.start(7,2);this.letterbox.fadeIn();if(this.servicePacks[0].active){this.achievementText=this.spawnEntity(EntityTextplayer,0,0,{drawX:1000,drawY:1300,textString:"ACHIEVEMENT UNLOCKED: HARDCORE",font:this.font_zoom2,fontAlignment:ig.Font.ALIGN.CENTER,framerate:0.02,duration:3.5});}},getOutroDetonator:function(currentSequence){this.chopperView=false;this.earthquake.kill();ig.game.sounds.choppa.stop();this.scaleValue=1;ig.system.width=ig.system.realWidth/this.scaleValue;ig.system.height=ig.system.realHeight/this.scaleValue;ig.game.screen.y=-5;ig.game.screen.x=1650;this.boom=ig.game.spawnEntity(EntityBgBoom,ig.game.screen.x,ig.game.screen.y);this.boomFlash=ig.game.spawnEntity(EntityBoomFlash,ig.game.screen.x,ig.game.screen.y);this.detonator=ig.game.spawnEntity(EntityOutroDetonator,ig.game.screen.x+90,90);var scope=this;this.sequenceTimeout=setTimeout(function(){scope.endingSequence.next();},1000);},getOutroText:function(currentSequence){this.sounds.typing.volume=.4;this.outroText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:90,drawY:460,textString:"YOU PUT UP ONE HELL OF A FIGHT. LET US\nGIVE YOU SOME XP SUPPORT ONE LAST TIME.",font:new ig.Font('media/fonts/FixedsysTTF_28_white.png')});this.outroText.addListener("complete",this.completeHander.bind(this));},getOutroText2:function(currentSequence){var scope=this;this.sequenceTimeout=setTimeout(function(){scope.outroText.kill();ig.input.bind(ig.KEY.MOUSE1,'mouse1');scope.detonator.light.currentAnim=scope.detonator.light.anims.blink;scope.detonator.key.currentAnim=scope.detonator.key.anims.turn;scope.outroText=ig.game.spawnEntity(EntityTextplayer,0,0,{drawX:90,drawY:460,textString:"HIT THE BUTTON AND KISS XP GOODBYE.",font:new ig.Font('media/fonts/FixedsysTTF_28_white.png')});scope.canBlow=true;ig.game.detonator.clippyTimer=new ig.Timer(ig.game.detonator.clippyDelay);},2000);},getNuke:function(){this.detonator.button.currentAnim=this.detonator.button.anims.push;var scope=this;this.sequenceTimeout=setTimeout(function(){ig.music.stop();ig.game.sounds.explosion.play();scope.outroText.kill();scope.detonator.kill();scope.letterbox.kill();scope.sequenceTimeout=setTimeout(function(){scope.earthquake=scope.spawnEntity(EntityEarthquake,300,300,{name:'quake'});scope.earthquake.start(10,6);scope.sequenceTimeout=setTimeout(function(){scope.makeItBoom(scope);ig.game.destroyEverthing();},1000);},2000);},500);},makeItBoom:function(scope){this.enemyFactory.paused=true;ig.game.boom.currentAnim=ig.game.boom.anims.go_boom.rewind();scope.sequenceTimeout=setTimeout(function(){scope.boomFlash.currentAnim=scope.boomFlash.anims.flash.rewind();scope.boomFlash.currentAnim.onComplete(function(){ig.game.endingSequence.next();});},200);},getOutroMedal:function(currentSequence){var scope=this;this.sequenceTimeout=setTimeout(function(){ig.game.sounds.explosion.stop();scope.loadLevel(LevelOutro);scope.credits=scope.spawnEntity(EntityOutroCredits,ig.game.screen.x,ig.game.screen.y);this.sequenceTimeout=setTimeout(function(){scope.outroText=scope.spawnEntity(EntityTextplayer,0,0,{drawX:98,drawY:460,textString:"THIS BATTLE IS OVER. SUPPORT HAS ENDED\nFOR WINDOWS XP. RIP IE6.",font:new ig.Font('media/fonts/FixedsysTTF_28_white.png')});scope.outroText.addListener("complete",scope.completeHander.bind(scope));},1000);},6000);},getFinalText:function(currentSequence){this.outroText.removeListener("complete",this.completeHander.bind(this));var scope=this;this.sequenceTimeout=setTimeout(function(){scope.outroText.kill();scope.outroText=scope.spawnEntity(EntityTextplayer,0,0,{drawX:92,drawY:460,textString:"WE'LL CONTINUE TO SUPPORT YOU ON THE\nFRONT LINES OF THE MODERN WEB WITH\nTOOLS AND RESOURCES FROM WWW.MODERN.IE.",font:new ig.Font('media/fonts/FixedsysTTF_28_white.png')});scope.outroText.addListener("complete",function(){scope.credits.rollTimer=new ig.Timer(5);})},2000);},destroyEverthing:function(){ig.game.sounds.enemy_death_1.volume=0.1;ig.game.sounds.volume=0.1;_.each(ig.game.getAllEnemies(),function(e){setTimeout(function(){e.kill();},ig.game.random.range(500,4000));});},findCollision:function(entity){for(var y=0;y<ig.system.height;y++){if(ig.game.collisionMap.trace(entity.pos.x,y,0,1,entity.size.x,1).collision.y){return y;}}},numberWithCommas:function(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");},installServicePack:function(id){var index=_.findIndex(this.servicePacks,{'id':id});if(this.state.intro){if(index!=-1){this.servicePacks[index].active=true;event.source.postMessage()
return"Installation Complete.\n "+this.servicePacks[index].mode+" Unlocked\n System Message: "+this.servicePacks[index].system}
else{return"Error x09082009: Service Pack Not Found"}}else{return"Windows XP has encountered an error while installing your service pack.\nError x07311981: Service Pack timestamp has expired."}}});ig.main('#canvas',MyGame,60,800,600,1,ig.XpLoader);});